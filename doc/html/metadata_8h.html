<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>zlomekFS: metadata.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_21c430ab3b7001ae39034eae6f7edf71.html">zfsd</a></div>
<h1>metadata.h File Reference</h1>Metadata management functions. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;inttypes.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &quot;<a class="el" href="zfs-prot_8h-source.html">zfs-prot.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="hardlink-list_8h-source.html">hardlink-list.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="journal_8h-source.html">journal.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="volume_8h-source.html">volume.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="fh_8h-source.html">fh.h</a>&quot;</code><br>

<p>
<a href="metadata_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmetadata__def.html">metadata_def</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Metadata for file.  <a href="structmetadata__def.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfh__mapping__def.html">fh_mapping_def</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File handle mapping.  <a href="structfh__mapping__def.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#095c33a9fcfde0046d27a69844c0eeda">GET_MODE</a>(MODE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#cf011cf23f27e684a76676f4bc333208">GET_MODETYPE</a>(MODE, TYPE)&nbsp;&nbsp;&nbsp;(GET_MODE (MODE) | ((TYPE) &lt;&lt; 24))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#015d31621627a1bf93ba2aaa94b3c2d6">GET_MODETYPE_MODE</a>(MODETYPE)&nbsp;&nbsp;&nbsp;((MODETYPE) &amp; UINT32_C (0xffffff))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#89a4189397dab8d128153f4f8866e0f8">GET_MODETYPE_TYPE</a>(MODETYPE)&nbsp;&nbsp;&nbsp;((MODETYPE) &gt;&gt; 24)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#a8aad131b2bdf5363ac23772a40b95cd">METADATA_NAME_SIZE</a>&nbsp;&nbsp;&nbsp;52</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#aa0b32aa8b3bfdc86dc151fcd869b2d4">METADATA_COMPLETE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#030952713d33815180e319656797ffaf">METADATA_UPDATED_TREE</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#3a900fa19d9307f11b3962972c302389">METADATA_MODIFIED_TREE</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#8f16e74e7eb9aedcde017e5d1a0bcdd1">METADATA_SHADOW</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#af3ee99dc104bd261dd8d791f4b866fe">METADATA_SHADOW_TREE</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#a8899553c6a058d838cf90a8c32a4d44">metadata_decode</a>&nbsp;&nbsp;&nbsp;NULL</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#b60df122c6463b5429697c66b04efd2e">metadata_encode</a>&nbsp;&nbsp;&nbsp;NULL</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef enum <a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82">metadata_type_def</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef <a class="el" href="structmetadata__def.html">metadata_def</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#3d8dd2c583f6cbab400d3e80b89334c0">metadata</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Metadata for file.  <a href="#3d8dd2c583f6cbab400d3e80b89334c0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef <a class="el" href="structfh__mapping__def.html">fh_mapping_def</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#ea5c156f7b7785083902710cce702390">fh_mapping</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File handle mapping.  <a href="#ea5c156f7b7785083902710cce702390"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82">metadata_type_def</a> { <br>
&nbsp;&nbsp;<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a825d9755fb1135d285588030d1bb04c00e">METADATA_TYPE_METADATA</a>, 
<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82dece6f2aab62dca93be6ccb804738968">METADATA_TYPE_FH_MAPPING</a>, 
<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a823ee820505cc54e6240312859f3b176e8">METADATA_TYPE_UPDATED</a>, 
<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a827cfb55f7357c114ccd834bf3190ec425">METADATA_TYPE_MODIFIED</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a8215cf88479b3c3c03330f9cd297b753eb">METADATA_TYPE_HARDLINKS</a>, 
<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82e92a05e367e3c56e8a2817d66cf0f390">METADATA_TYPE_JOURNAL</a>, 
<a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a8240ae1725d2fc89da767e96d7161e26c6">METADATA_TYPE_SHADOW</a>
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#a2f8c98f291f07e359e54e823f6c711e">metadata_hash</a> (const void *x)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#546ae02aa9b6fa4eff2db0ffd01aaa54">metadata_eq</a> (const void *x, const void *y)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="zfs-prot_8h.html#fd6f88a62c177fab51044d30a2bc4587">ftype</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#cca3aa646269f83054c58b6ca1a53b7f">zfs_mode_to_ftype</a> (uint32_t mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#1bd74b569275131df722d300d754e43b">init_volume_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#309a7771f53cdf846bf361559dd4774c">close_volume_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#7310c189acd2b5398864012f4fe8a48a">close_interval_file</a> (<a class="el" href="structinterval__tree__def.html">interval_tree</a> tree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#2dc9d9eea2254d262d8c98b3dfced2cd">close_journal_file</a> (<a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#acf9c322b0e516c9684f67d2daaed9d1">flush_interval_tree</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#65345a169c527832eb9533c81d419d3e">append_interval</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, uint64_t start, uint64_t end)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#9b5f2db967551a3e834b9b2aa973554f">set_attr_version</a> (<a class="el" href="structfattr__def.html">fattr</a> *attr, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#a6db1869c9245582c4cad2ec5f3dfdbf">lookup_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, bool <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#d2ea3c7de573fc6f1d7dc66a69d6fe83">get_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#443d6b92e7a0693e943650e0e276decf">get_fh_mapping_for_master_fh</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh, <a class="el" href="structfh__mapping__def.html">fh_mapping</a> *map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#58f86881a12b09f757eff3241615ea2d">flush_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#592bd1089b07aefa0a78331e28d15004">set_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, uint32_t flags, uint64_t local_version, uint64_t master_version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#6f233b6f69a1cdcb8173d7bfbb2ccbab">set_metadata_flags</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, uint32_t flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#93fbef76cf9854a4544d6fb002cf29c0">set_metadata_master_fh</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#897bd01c8723d93be02c6b630a32c497">inc_local_version</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#a1cd65ebea4df0e0e9f4f9bc5fb3912c">inc_local_version_and_modified</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#85c5601fec008dc29019077393ec9506">delete_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t dev, uint32_t ino, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#97aad1538e86290b320767a0d6480d19">delete_metadata_of_created_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#976d00e136b8bd8d1a9649593a09c697">load_interval_trees</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#61e7d7f277cd3c4caf628287c8e508c2">save_interval_trees</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#3ade408acdb1b20b7599e7779a0c5b84">init_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structhardlink__list__def.html">hardlink_list</a> hl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#518c9b4dbad8f0c6a586a469148a10a3">read_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structhardlink__list__def.html">hardlink_list</a> hl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#24a97564272128df1634ba54c890c594">metadata_hardlink_insert</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#9afd87ae1e63ab84565a636402d3ce87">metadata_hardlink_replace</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t old_parent_dev, uint32_t old_parent_ino, <a class="el" href="structstring__def.html">string</a> *old_name, uint32_t new_parent_dev, uint32_t new_parent_ino, <a class="el" href="structstring__def.html">string</a> *new_name, bool shadow)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#67f5457a19aa44cb6ef37dfc9b5af2af">metadata_hardlink_set</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#8aa2d9597003dbf4b52e8df0acbb0d71">metadata_n_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#09c2cc02c843bcc92e776cf3f63f9ea5">get_local_path_from_metadata</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#9785edb2815efbcd6f2a52169997151e">read_journal</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#ef49d0ce915f8bc578649f4ece027342">write_journal</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#31ca0ee68a26321afbe6dd39d1b2e117">add_journal_entry</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *local_fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh, uint64_t master_version, <a class="el" href="structstring__def.html">string</a> *name, <a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a> oper)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#911d4e4e10147ecbf55f7d921d2f0d71">add_journal_entry_meta</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structstring__def.html">string</a> *name, <a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a> oper)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#bbb4ba5f042b5630bb1bb14735c8026f">create_shadow_path</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#8409ce6494102bda76a0b2a2e1e210c0">initialize_metadata_c</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#3ada2ea3ac4856cb87415dbed528adc1">cleanup_metadata_c</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="metadata_8h.html#0897dc5e6757cea8fad80b1c414dee72">metadata_tree_depth</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Metadata management functions. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="095c33a9fcfde0046d27a69844c0eeda"></a><!-- doxytag: member="metadata.h::GET_MODE" ref="095c33a9fcfde0046d27a69844c0eeda" args="(MODE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_MODE          </td>
          <td>(</td>
          <td class="paramtype">MODE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">((MODE) &amp; (S_IRWXU | S_IRWXG | S_IRWXO          \
                                  | S_ISUID | S_ISGID | S_ISVTX))
</pre></div>Get mode from MODE from struct stat. 
</div>
</div><p>
<a class="anchor" name="cf011cf23f27e684a76676f4bc333208"></a><!-- doxytag: member="metadata.h::GET_MODETYPE" ref="cf011cf23f27e684a76676f4bc333208" args="(MODE, TYPE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_MODETYPE          </td>
          <td>(</td>
          <td class="paramtype">MODE,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TYPE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(GET_MODE (MODE) | ((TYPE) &lt;&lt; 24))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute a combination of MODE and TYPE. 
</div>
</div><p>
<a class="anchor" name="015d31621627a1bf93ba2aaa94b3c2d6"></a><!-- doxytag: member="metadata.h::GET_MODETYPE_MODE" ref="015d31621627a1bf93ba2aaa94b3c2d6" args="(MODETYPE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_MODETYPE_MODE          </td>
          <td>(</td>
          <td class="paramtype">MODETYPE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((MODETYPE) &amp; UINT32_C (0xffffff))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get mode from MODETYPE. 
</div>
</div><p>
<a class="anchor" name="89a4189397dab8d128153f4f8866e0f8"></a><!-- doxytag: member="metadata.h::GET_MODETYPE_TYPE" ref="89a4189397dab8d128153f4f8866e0f8" args="(MODETYPE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_MODETYPE_TYPE          </td>
          <td>(</td>
          <td class="paramtype">MODETYPE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((MODETYPE) &gt;&gt; 24)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get type from MODETYPE. 
</div>
</div><p>
<a class="anchor" name="aa0b32aa8b3bfdc86dc151fcd869b2d4"></a><!-- doxytag: member="metadata.h::METADATA_COMPLETE" ref="aa0b32aa8b3bfdc86dc151fcd869b2d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_COMPLETE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
file is complete, should be XOR with METADATA_MODIFIED_TREE 
</div>
</div><p>
<a class="anchor" name="a8899553c6a058d838cf90a8c32a4d44"></a><!-- doxytag: member="metadata.h::metadata_decode" ref="a8899553c6a058d838cf90a8c32a4d44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define metadata_decode&nbsp;&nbsp;&nbsp;NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="b60df122c6463b5429697c66b04efd2e"></a><!-- doxytag: member="metadata.h::metadata_encode" ref="b60df122c6463b5429697c66b04efd2e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define metadata_encode&nbsp;&nbsp;&nbsp;NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3a900fa19d9307f11b3962972c302389"></a><!-- doxytag: member="metadata.h::METADATA_MODIFIED_TREE" ref="3a900fa19d9307f11b3962972c302389" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_MODIFIED_TREE&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
file has a modified interval tree, no effect on METADATA_COMPLETE (it seems) 
</div>
</div><p>
<a class="anchor" name="a8aad131b2bdf5363ac23772a40b95cd"></a><!-- doxytag: member="metadata.h::METADATA_NAME_SIZE" ref="a8aad131b2bdf5363ac23772a40b95cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_NAME_SIZE&nbsp;&nbsp;&nbsp;52          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The size of char array for file name stored in hash table. Longer names are stored in separate files together with hardlinks. 
</div>
</div><p>
<a class="anchor" name="8f16e74e7eb9aedcde017e5d1a0bcdd1"></a><!-- doxytag: member="metadata.h::METADATA_SHADOW" ref="8f16e74e7eb9aedcde017e5d1a0bcdd1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_SHADOW&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
file is in shadow 
</div>
</div><p>
<a class="anchor" name="af3ee99dc104bd261dd8d791f4b866fe"></a><!-- doxytag: member="metadata.h::METADATA_SHADOW_TREE" ref="af3ee99dc104bd261dd8d791f4b866fe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_SHADOW_TREE&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dir is a part of shadow tree 
</div>
</div><p>
<a class="anchor" name="030952713d33815180e319656797ffaf"></a><!-- doxytag: member="metadata.h::METADATA_UPDATED_TREE" ref="030952713d33815180e319656797ffaf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_UPDATED_TREE&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
file has an updated interval tree, should be XOR with METADATA_COMPLETE 
</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="ea5c156f7b7785083902710cce702390"></a><!-- doxytag: member="metadata.h::fh_mapping" ref="ea5c156f7b7785083902710cce702390" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structfh__mapping__def.html">fh_mapping_def</a>  <a class="el" href="structfh__mapping__def.html">fh_mapping</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
File handle mapping. 
<p>

</div>
</div><p>
<a class="anchor" name="3d8dd2c583f6cbab400d3e80b89334c0"></a><!-- doxytag: member="metadata.h::metadata" ref="3d8dd2c583f6cbab400d3e80b89334c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmetadata__def.html">metadata_def</a>  <a class="el" href="structmetadata__def.html">metadata</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Metadata for file. 
<p>

</div>
</div><p>
<a class="anchor" name="548e14ed3091a841ff4c0eb02062d78e"></a><!-- doxytag: member="metadata.h::metadata_type" ref="548e14ed3091a841ff4c0eb02062d78e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82">metadata_type_def</a>  <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Type of metadata. 
</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="2635928e587c14b40f00cfc01fa80a82"></a><!-- doxytag: member="metadata.h::metadata_type_def" ref="2635928e587c14b40f00cfc01fa80a82" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="metadata_8h.html#2635928e587c14b40f00cfc01fa80a82">metadata_type_def</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Type of metadata. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a825d9755fb1135d285588030d1bb04c00e"></a><!-- doxytag: member="METADATA_TYPE_METADATA" ref="2635928e587c14b40f00cfc01fa80a825d9755fb1135d285588030d1bb04c00e" args="" -->METADATA_TYPE_METADATA</em>&nbsp;</td><td>
Generic metadata hashed by local file handle. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a82dece6f2aab62dca93be6ccb804738968"></a><!-- doxytag: member="METADATA_TYPE_FH_MAPPING" ref="2635928e587c14b40f00cfc01fa80a82dece6f2aab62dca93be6ccb804738968" args="" -->METADATA_TYPE_FH_MAPPING</em>&nbsp;</td><td>
Mapping of master file handle to local file handle. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a823ee820505cc54e6240312859f3b176e8"></a><!-- doxytag: member="METADATA_TYPE_UPDATED" ref="2635928e587c14b40f00cfc01fa80a823ee820505cc54e6240312859f3b176e8" args="" -->METADATA_TYPE_UPDATED</em>&nbsp;</td><td>
Intervals updated from master node. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a827cfb55f7357c114ccd834bf3190ec425"></a><!-- doxytag: member="METADATA_TYPE_MODIFIED" ref="2635928e587c14b40f00cfc01fa80a827cfb55f7357c114ccd834bf3190ec425" args="" -->METADATA_TYPE_MODIFIED</em>&nbsp;</td><td>
Intervals modified by local node. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a8215cf88479b3c3c03330f9cd297b753eb"></a><!-- doxytag: member="METADATA_TYPE_HARDLINKS" ref="2635928e587c14b40f00cfc01fa80a8215cf88479b3c3c03330f9cd297b753eb" args="" -->METADATA_TYPE_HARDLINKS</em>&nbsp;</td><td>
List of hardlinks for file handle. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a82e92a05e367e3c56e8a2817d66cf0f390"></a><!-- doxytag: member="METADATA_TYPE_JOURNAL" ref="2635928e587c14b40f00cfc01fa80a82e92a05e367e3c56e8a2817d66cf0f390" args="" -->METADATA_TYPE_JOURNAL</em>&nbsp;</td><td>
Journal of modifications of a directory. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2635928e587c14b40f00cfc01fa80a8240ae1725d2fc89da767e96d7161e26c6"></a><!-- doxytag: member="METADATA_TYPE_SHADOW" ref="2635928e587c14b40f00cfc01fa80a8240ae1725d2fc89da767e96d7161e26c6" args="" -->METADATA_TYPE_SHADOW</em>&nbsp;</td><td>
File which is not accessible in the directory tree yet. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="31ca0ee68a26321afbe6dd39d1b2e117"></a><!-- doxytag: member="metadata.h::add_journal_entry" ref="31ca0ee68a26321afbe6dd39d1b2e117" args="(volume vol, journal_t journal, zfs_fh *fh, zfs_fh *local_fh, zfs_fh *master_fh, uint64_t master_version, string *name, journal_operation_t oper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool add_journal_entry           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>local_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>master_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a>&nbsp;</td>
          <td class="paramname"> <em>oper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a journal entry with key [LOCAL_FH, NAME], master file handle MASTER_FH, master version MASTER_VERSION and operation OPER to journal JOURNAL for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="911d4e4e10147ecbf55f7d921d2f0d71"></a><!-- doxytag: member="metadata.h::add_journal_entry_meta" ref="911d4e4e10147ecbf55f7d921d2f0d71" args="(volume vol, journal_t journal, zfs_fh *fh, metadata *meta, string *name, journal_operation_t oper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool add_journal_entry_meta           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a>&nbsp;</td>
          <td class="paramname"> <em>oper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a journal entry for file with metadata META, name NAME and operation OPER to journal JOURNAL for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="65345a169c527832eb9533c81d419d3e"></a><!-- doxytag: member="metadata.h::append_interval" ref="65345a169c527832eb9533c81d419d3e" args="(volume vol, internal_fh fh, metadata_type type, uint64_t start, uint64_t end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool append_interval           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the interval [START, END) to the end of interval file of type TYPE for file handle FH on volume VOL. Open the interval file for appending when it is not opened. 
</div>
</div><p>
<a class="anchor" name="3ada2ea3ac4856cb87415dbed528adc1"></a><!-- doxytag: member="metadata.h::cleanup_metadata_c" ref="3ada2ea3ac4856cb87415dbed528adc1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_metadata_c           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy data structures in METADATA.C. 
</div>
</div><p>
<a class="anchor" name="7310c189acd2b5398864012f4fe8a48a"></a><!-- doxytag: member="metadata.h::close_interval_file" ref="7310c189acd2b5398864012f4fe8a48a" args="(interval_tree tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_interval_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterval__tree__def.html">interval_tree</a>&nbsp;</td>
          <td class="paramname"> <em>tree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file for interval tree TREE. 
</div>
</div><p>
<a class="anchor" name="2dc9d9eea2254d262d8c98b3dfced2cd"></a><!-- doxytag: member="metadata.h::close_journal_file" ref="2dc9d9eea2254d262d8c98b3dfced2cd" args="(journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_journal_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file for journal JOURNAL. 
</div>
</div><p>
<a class="anchor" name="309a7771f53cdf846bf361559dd4774c"></a><!-- doxytag: member="metadata.h::close_volume_metadata" ref="309a7771f53cdf846bf361559dd4774c" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_volume_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close hash file containing metadata for volume VOL. 
</div>
</div><p>
<a class="anchor" name="bbb4ba5f042b5630bb1bb14735c8026f"></a><!-- doxytag: member="metadata.h::create_shadow_path" ref="bbb4ba5f042b5630bb1bb14735c8026f" args="(string *path, volume vol, zfs_fh *fh, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool create_shadow_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build and create path PATH to shadow file for file FH with name NAME on volume VOL. 
</div>
</div><p>
<a class="anchor" name="85c5601fec008dc29019077393ec9506"></a><!-- doxytag: member="metadata.h::delete_metadata" ref="85c5601fec008dc29019077393ec9506" args="(volume vol, metadata *meta, uint32_t dev, uint32_t ino, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool delete_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete all metadata files for file on volume VOL with device DEV and inode INO and hardlink [PARENT_DEV, PARENT_INO, NAME]. 
</div>
</div><p>
<a class="anchor" name="97aad1538e86290b320767a0d6480d19"></a><!-- doxytag: member="metadata.h::delete_metadata_of_created_file" ref="97aad1538e86290b320767a0d6480d19" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool delete_metadata_of_created_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete master fh and fh mapping for newly created file FH with metadata META on volume VOL. 
</div>
</div><p>
<a class="anchor" name="acf9c322b0e516c9684f67d2daaed9d1"></a><!-- doxytag: member="metadata.h::flush_interval_tree" ref="acf9c322b0e516c9684f67d2daaed9d1" args="(volume vol, internal_fh fh, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool flush_interval_tree           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flush the interval tree of type TYPE for file handle FH on volume VOL to file. 
</div>
</div><p>
<a class="anchor" name="58f86881a12b09f757eff3241615ea2d"></a><!-- doxytag: member="metadata.h::flush_metadata" ref="58f86881a12b09f757eff3241615ea2d" args="(volume vol, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool flush_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the metadata META to list file on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="443d6b92e7a0693e943650e0e276decf"></a><!-- doxytag: member="metadata.h::get_fh_mapping_for_master_fh" ref="443d6b92e7a0693e943650e0e276decf" args="(volume vol, zfs_fh *master_fh, fh_mapping *map)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool get_fh_mapping_for_master_fh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfh__mapping__def.html">fh_mapping</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get file handle mapping for master file handle MASTER_FH on volume VOL and store it to MAP. 
</div>
</div><p>
<a class="anchor" name="09c2cc02c843bcc92e776cf3f63f9ea5"></a><!-- doxytag: member="metadata.h::get_local_path_from_metadata" ref="09c2cc02c843bcc92e776cf3f63f9ea5" args="(string *path, volume vol, zfs_fh *fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_local_path_from_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a local path for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="d2ea3c7de573fc6f1d7dc66a69d6fe83"></a><!-- doxytag: member="metadata.h::get_metadata" ref="d2ea3c7de573fc6f1d7dc66a69d6fe83" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool get_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get metadata for file handle FH on volume VOL. Store the metadata to META and update FH-&gt;GEN. Unlock the volume. 
</div>
</div><p>
<a class="anchor" name="897bd01c8723d93be02c6b630a32c497"></a><!-- doxytag: member="metadata.h::inc_local_version" ref="897bd01c8723d93be02c6b630a32c497" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool inc_local_version           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Increase the local version for file FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="a1cd65ebea4df0e0e9f4f9bc5fb3912c"></a><!-- doxytag: member="metadata.h::inc_local_version_and_modified" ref="a1cd65ebea4df0e0e9f4f9bc5fb3912c" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool inc_local_version_and_modified           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Increase the local version for file FH on volume VOL and set MODIFIED flag. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="3ade408acdb1b20b7599e7779a0c5b84"></a><!-- doxytag: member="metadata.h::init_hardlinks" ref="3ade408acdb1b20b7599e7779a0c5b84" args="(volume vol, zfs_fh *fh, metadata *meta, hardlink_list hl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1bd74b569275131df722d300d754e43b"></a><!-- doxytag: member="metadata.h::init_volume_metadata" ref="1bd74b569275131df722d300d754e43b" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_volume_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize hash file containing metadata for volume VOL. 
</div>
</div><p>
<a class="anchor" name="8409ce6494102bda76a0b2a2e1e210c0"></a><!-- doxytag: member="metadata.h::initialize_metadata_c" ref="8409ce6494102bda76a0b2a2e1e210c0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_metadata_c           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize data structures in METADATA.C. 
</div>
</div><p>
<a class="anchor" name="976d00e136b8bd8d1a9649593a09c697"></a><!-- doxytag: member="metadata.h::load_interval_trees" ref="976d00e136b8bd8d1a9649593a09c697" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool load_interval_trees           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load interval trees for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="a6db1869c9245582c4cad2ec5f3dfdbf"></a><!-- doxytag: member="metadata.h::lookup_metadata" ref="a6db1869c9245582c4cad2ec5f3dfdbf" args="(volume vol, zfs_fh *fh, metadata *meta, bool insert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lookup_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>insert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Lookup metadata for file handle FH on volume VOL. Store the metadata to META and update FH-&gt;GEN. Insert the metadata to hash file if INSERT is true and the metadata was not found. 
</div>
</div><p>
<a class="anchor" name="546ae02aa9b6fa4eff2db0ffd01aaa54"></a><!-- doxytag: member="metadata.h::metadata_eq" ref="546ae02aa9b6fa4eff2db0ffd01aaa54" args="(const void *x, const void *y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int metadata_eq           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>y</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare element X of hash file with possible element Y. 
</div>
</div><p>
<a class="anchor" name="24a97564272128df1634ba54c890c594"></a><!-- doxytag: member="metadata.h::metadata_hardlink_insert" ref="24a97564272128df1634ba54c890c594" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_insert           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Insert a hardlink [PARENT_DEV, PARENT_INO, NAME] to hardlink list for file handle FH on volume VOL. Use META for loading metadata. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="9afd87ae1e63ab84565a636402d3ce87"></a><!-- doxytag: member="metadata.h::metadata_hardlink_replace" ref="9afd87ae1e63ab84565a636402d3ce87" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t old_parent_dev, uint32_t old_parent_ino, string *old_name, uint32_t new_parent_dev, uint32_t new_parent_ino, string *new_name, bool shadow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_replace           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>old_parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>old_parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>old_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>new_parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>new_parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>new_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>shadow</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Replace a hardlink [OLD_PARENT_DEV, OLD_PARENT_INO, OLD_NAME] by [NEW_PARENT_DEV, NEW_PARENT_INO, NEW_NAME] in hardlink list for file handle FH on volume VOL. Use META for loading metadata. If SHADOW is true set the METADATA_SHADOW flag, otherwise clear it. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="67f5457a19aa44cb6ef37dfc9b5af2af"></a><!-- doxytag: member="metadata.h::metadata_hardlink_set" ref="67f5457a19aa44cb6ef37dfc9b5af2af" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_set           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear the hardlink list of file FH on volume VOL and add a hardlink specifying that the file is in shadow. 
</div>
</div><p>
<a class="anchor" name="a2f8c98f291f07e359e54e823f6c711e"></a><!-- doxytag: member="metadata.h::metadata_hash" ref="a2f8c98f291f07e359e54e823f6c711e" args="(const void *x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a> metadata_hash           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hash function for metadata X. 
</div>
</div><p>
<a class="anchor" name="8aa2d9597003dbf4b52e8df0acbb0d71"></a><!-- doxytag: member="metadata.h::metadata_n_hardlinks" ref="8aa2d9597003dbf4b52e8df0acbb0d71" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int metadata_n_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the number of hardlinks of file FH on volume VOL and store the metadata to META. 
</div>
</div><p>
<a class="anchor" name="518c9b4dbad8f0c6a586a469148a10a3"></a><!-- doxytag: member="metadata.h::read_hardlinks" ref="518c9b4dbad8f0c6a586a469148a10a3" args="(volume vol, zfs_fh *fh, metadata *meta, hardlink_list hl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool read_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read hardlinks for file handle FH on volume VOL to hardlink list HL and the metadata to META. 
</div>
</div><p>
<a class="anchor" name="9785edb2815efbcd6f2a52169997151e"></a><!-- doxytag: member="metadata.h::read_journal" ref="9785edb2815efbcd6f2a52169997151e" args="(volume vol, zfs_fh *fh, journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool read_journal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read journal for file handle FH on volume VOL to JOURNAL. 
</div>
</div><p>
<a class="anchor" name="61e7d7f277cd3c4caf628287c8e508c2"></a><!-- doxytag: member="metadata.h::save_interval_trees" ref="61e7d7f277cd3c4caf628287c8e508c2" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool save_interval_trees           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Save interval trees for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="9b5f2db967551a3e834b9b2aa973554f"></a><!-- doxytag: member="metadata.h::set_attr_version" ref="9b5f2db967551a3e834b9b2aa973554f" args="(fattr *attr, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_attr_version           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfattr__def.html">fattr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set version in attributes ATTR according to metadata META. 
</div>
</div><p>
<a class="anchor" name="592bd1089b07aefa0a78331e28d15004"></a><!-- doxytag: member="metadata.h::set_metadata" ref="592bd1089b07aefa0a78331e28d15004" args="(volume vol, internal_fh fh, uint32_t flags, uint64_t local_version, uint64_t master_version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>local_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>master_version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set metadata (FLAGS, LOCAL_VERSION, MASTER_VERSION) for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="6f233b6f69a1cdcb8173d7bfbb2ccbab"></a><!-- doxytag: member="metadata.h::set_metadata_flags" ref="6f233b6f69a1cdcb8173d7bfbb2ccbab" args="(volume vol, internal_fh fh, uint32_t flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata_flags           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set metadata flags FLAGS for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="93fbef76cf9854a4544d6fb002cf29c0"></a><!-- doxytag: member="metadata.h::set_metadata_master_fh" ref="93fbef76cf9854a4544d6fb002cf29c0" args="(volume vol, internal_fh fh, zfs_fh *master_fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata_master_fh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set master_fh to MASTER_FH in metadata for file handle FH on volume VOL and update reverse file handle mapping. 
</div>
</div><p>
<a class="anchor" name="ef49d0ce915f8bc578649f4ece027342"></a><!-- doxytag: member="metadata.h::write_journal" ref="ef49d0ce915f8bc578649f4ece027342" args="(volume vol, zfs_fh *fh, journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool write_journal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the journal JOURNAL for file handle FH on volume VOL to appropriate file. 
</div>
</div><p>
<a class="anchor" name="cca3aa646269f83054c58b6ca1a53b7f"></a><!-- doxytag: member="metadata.h::zfs_mode_to_ftype" ref="cca3aa646269f83054c58b6ca1a53b7f" args="(uint32_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="zfs-prot_8h.html#fd6f88a62c177fab51044d30a2bc4587">ftype</a> zfs_mode_to_ftype           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>mode</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return file type from struct stat's MODE. 
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="0897dc5e6757cea8fad80b1c414dee72"></a><!-- doxytag: member="metadata.h::metadata_tree_depth" ref="0897dc5e6757cea8fad80b1c414dee72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="metadata_8h.html#0897dc5e6757cea8fad80b1c414dee72">metadata_tree_depth</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Depth of directory tree for saving metadata about files. 
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 6 00:39:38 2010 for zlomekFS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
