<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>zlomekFS: hashtab.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_21c430ab3b7001ae39034eae6f7edf71.html">zfsd</a></div>
<h1>hashtab.c File Reference</h1>An expandable hash tables datatype. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="pthread-wrapper_8h-source.html">pthread-wrapper.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="hashtab_8h-source.html">hashtab.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="log_8h-source.html">log.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="memory_8h-source.html">memory.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#3a14ba2ffcd9ba31c04349c1caa958a0">N_PRIMES</a>&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>) / sizeof(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>[0]))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#ce514476fd5d41152b4eb5d43dd536c6">MAX_PRIME</a>&nbsp;&nbsp;&nbsp;(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>[N_PRIMES - 1])</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#b32d409253124c7182628ec004f3f94f">get_higher_prime</a> (unsigned int n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#2d752f5de93feaf6cf04b42eb34daf78">htab_find_empty_slot</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, <a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a> hash)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#0e705b0e1e242d7957f527902b5fed7a">htab_expand</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#5b1ea2d70712971386686b6f3e9112b9">htab_create</a> (unsigned int size, <a class="el" href="hashtab_8h.html#a7a7c4d303065041c1f2e1ad4a5e8a66">htab_hash</a> hash_f, <a class="el" href="hashtab_8h.html#430656812b9c8fa26743278d381f9af7">htab_eq</a> eq_f, <a class="el" href="hashtab_8h.html#d89b993695437fe97f55daa4d2fd98e0">htab_del</a> del_f, pthread_mutex_t *mutex)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#1c32d7a7e0a650bb0e775e429c90857b">htab_destroy</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#bf5577eb61bfa198c037f59bb1874e8e">htab_empty</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#49f4e905d1a0338af3e6be5e06b7a23c">htab_clear_slot</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, void **slot)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#42cb7b200b55021f6e3ff72fcaad39f1">htab_find</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, const void *elem)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#ca4ebd96384f1bfe4d2ed985a3622bc6">htab_find_with_hash</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, const void *elem, <a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a> hash)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#cbfa57fc518a31f636afc49ad4e378fd">htab_find_slot</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, const void *elem, enum <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a> <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#820649fbefb2ffcdf778a17b5092180b">htab_find_slot_with_hash</a> (<a class="el" href="structhtab__def.html">htab_t</a> htab, const void *elem, <a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a> hash, enum <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a> <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a> []</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
An expandable hash tables datatype. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="ce514476fd5d41152b4eb5d43dd536c6"></a><!-- doxytag: member="hashtab.c::MAX_PRIME" ref="ce514476fd5d41152b4eb5d43dd536c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PRIME&nbsp;&nbsp;&nbsp;(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>[N_PRIMES - 1])          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3a14ba2ffcd9ba31c04349c1caa958a0"></a><!-- doxytag: member="hashtab.c::N_PRIMES" ref="3a14ba2ffcd9ba31c04349c1caa958a0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_PRIMES&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>) / sizeof(<a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>[0]))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="b32d409253124c7182628ec004f3f94f"></a><!-- doxytag: member="hashtab.c::get_higher_prime" ref="b32d409253124c7182628ec004f3f94f" args="(unsigned int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int get_higher_prime           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>n</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a prime number from the predecessing table which is greater or equal to N. 
</div>
</div><p>
<a class="anchor" name="49f4e905d1a0338af3e6be5e06b7a23c"></a><!-- doxytag: member="hashtab.c::htab_clear_slot" ref="49f4e905d1a0338af3e6be5e06b7a23c" args="(htab_t htab, void **slot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htab_clear_slot           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&nbsp;</td>
          <td class="paramname"> <em>slot</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear the slot SLOT of the hash table HTAB. If the cleanup function is defined it is called for the element in slot. 
</div>
</div><p>
<a class="anchor" name="5b1ea2d70712971386686b6f3e9112b9"></a><!-- doxytag: member="hashtab.c::htab_create" ref="5b1ea2d70712971386686b6f3e9112b9" args="(unsigned int size, htab_hash hash_f, htab_eq eq_f, htab_del del_f, pthread_mutex_t *mutex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtab__def.html">htab_t</a> htab_create           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#a7a7c4d303065041c1f2e1ad4a5e8a66">htab_hash</a>&nbsp;</td>
          <td class="paramname"> <em>hash_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#430656812b9c8fa26743278d381f9af7">htab_eq</a>&nbsp;</td>
          <td class="paramname"> <em>eq_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#d89b993695437fe97f55daa4d2fd98e0">htab_del</a>&nbsp;</td>
          <td class="paramname"> <em>del_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pthread_mutex_t *&nbsp;</td>
          <td class="paramname"> <em>mutex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create the hash table data structure with SIZE elements, hash function HASH_F, compare function EQ_F and element cleanup function DEL_F. 
</div>
</div><p>
<a class="anchor" name="1c32d7a7e0a650bb0e775e429c90857b"></a><!-- doxytag: member="hashtab.c::htab_destroy" ref="1c32d7a7e0a650bb0e775e429c90857b" args="(htab_t htab)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htab_destroy           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy the hash table HTAB. If the cleanup function is defined it is called for each present element. 
</div>
</div><p>
<a class="anchor" name="bf5577eb61bfa198c037f59bb1874e8e"></a><!-- doxytag: member="hashtab.c::htab_empty" ref="bf5577eb61bfa198c037f59bb1874e8e" args="(htab_t htab)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htab_empty           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear all elements of hash table HTAB. 
</div>
</div><p>
<a class="anchor" name="0e705b0e1e242d7957f527902b5fed7a"></a><!-- doxytag: member="hashtab.c::htab_expand" ref="0e705b0e1e242d7957f527902b5fed7a" args="(htab_t htab)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htab_expand           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Expand the hash table HTAB. 
</div>
</div><p>
<a class="anchor" name="42cb7b200b55021f6e3ff72fcaad39f1"></a><!-- doxytag: member="hashtab.c::htab_find" ref="42cb7b200b55021f6e3ff72fcaad39f1" args="(htab_t htab, const void *elem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* htab_find           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>elem</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Similar to HTAB_FIND_WITH_HASH but it computes the hash key first. 
</div>
</div><p>
<a class="anchor" name="2d752f5de93feaf6cf04b42eb34daf78"></a><!-- doxytag: member="hashtab.c::htab_find_empty_slot" ref="2d752f5de93feaf6cf04b42eb34daf78" args="(htab_t htab, hash_t hash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void** htab_find_empty_slot           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a>&nbsp;</td>
          <td class="paramname"> <em>hash</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find an empty slot for htab_expand. HASH is the hash value for the element to be inserted. Expects no deleted slots in the table. 
</div>
</div><p>
<a class="anchor" name="cbfa57fc518a31f636afc49ad4e378fd"></a><!-- doxytag: member="hashtab.c::htab_find_slot" ref="cbfa57fc518a31f636afc49ad4e378fd" args="(htab_t htab, const void *elem, enum insert insert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void** htab_find_slot           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a> <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Similar to HTAB_FIND_SLOT_WITH_HASH but it computes the hash key first. 
</div>
</div><p>
<a class="anchor" name="820649fbefb2ffcdf778a17b5092180b"></a><!-- doxytag: member="hashtab.c::htab_find_slot_with_hash" ref="820649fbefb2ffcdf778a17b5092180b" args="(htab_t htab, const void *elem, hash_t hash, enum insert insert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void** htab_find_slot_with_hash           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a>&nbsp;</td>
          <td class="paramname"> <em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a> <a class="el" href="hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find the slot of hash table HTAB which contains element ELEM with hash key HASH. The compare function is called for comparion the elements. If INSERT is true and element is not present in the hash table it is inserted. 
</div>
</div><p>
<a class="anchor" name="ca4ebd96384f1bfe4d2ed985a3622bc6"></a><!-- doxytag: member="hashtab.c::htab_find_with_hash" ref="ca4ebd96384f1bfe4d2ed985a3622bc6" args="(htab_t htab, const void *elem, hash_t hash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* htab_find_with_hash           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtab__def.html">htab_t</a>&nbsp;</td>
          <td class="paramname"> <em>htab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a>&nbsp;</td>
          <td class="paramname"> <em>hash</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find the element ELEM whose hash key is HASH in hash table HTAB. This function cannot be used to insert or delete an element, use htab_find_slot_with_hash and htab_clear_slot for that purpose. 
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="fa0b3f5a7c236c57525153e59dd3c608"></a><!-- doxytag: member="hashtab.c::primes" ref="fa0b3f5a7c236c57525153e59dd3c608" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="hashtab_8c.html#fa0b3f5a7c236c57525153e59dd3c608">primes</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
These are primes that are the highest primes lower than some power of 2. 
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 6 00:39:37 2010 for zlomekFS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
