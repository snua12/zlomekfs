<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>zlomekFS: network.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_21c430ab3b7001ae39034eae6f7edf71.html">zfsd</a></div>
<h1>network.c File Reference</h1>Network thread functions. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;inttypes.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;sys/poll.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &quot;<a class="el" href="pthread-wrapper_8h-source.html">pthread-wrapper.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="constant_8h-source.html">constant.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="memory_8h-source.html">memory.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="semaphore_8h-source.html">semaphore.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="data-coding_8h-source.html">data-coding.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="network_8h-source.html">network.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="kernel_8h-source.html">kernel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="log_8h-source.html">log.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="util_8h-source.html">util.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="thread_8h-source.html">thread.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="zfs-prot_8h-source.html">zfs-prot.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="node_8h-source.html">node.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="volume_8h-source.html">volume.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="hashtab_8h-source.html">hashtab.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="alloc-pool_8h-source.html">alloc-pool.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="fh_8h-source.html">fh.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="zfs-prot_8def.html">zfs-prot.def</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#d0be2a5b4bdceac3b131778e93ccc595">ZFS_CALL_SERVER</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#f13257efb2c2f048be8111da8e45ca74">DEFINE_ZFS_PROC</a>(NUMBER, NAME, FUNCTION, ARGS, AUTH, CALL_MODE)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#5dfe1a1b5d917369b28a28a0dc916f5d">waiting4reply_hash</a> (const void *xx)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#b05e13e2874f423b317be094e6b343d4">waiting4reply_eq</a> (const void *xx, const void *yy)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#aecb02d3fd18be9903ded6e573e99f10">init_fd_data</a> (int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#14699d17ece2e57470a2600ce6a0d6ae">add_fd_to_active</a> (int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#0ec9e7d253e53484c6965f99845e7ba0">update_node_fd</a> (<a class="el" href="structnode__def.html">node</a> nod, int fd, unsigned int generation, bool active_open)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#d69b54caf868fa84a6a166482f284837">wake_all_threads</a> (<a class="el" href="structfd__data__def.html">fd_data_t</a> *fd_data, int32_t retval)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#01208284c3394d58d268d1394ad3d2a9">close_network_fd</a> (int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#546f6c3fb6ffc4d7c7a2788ad3bd2334">close_active_fd</a> (int i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#da5d5652301ebe83082f39bcf4b8d9cd">node_has_valid_fd</a> (<a class="el" href="structnode__def.html">node</a> nod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a13352611b8d3fccf9947ad576fb6644">node_connected</a> (uint32_t sid, unsigned int *generation)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="zfs-prot_8h.html#9e8c56217c02c355396741e69be2422a">connection_speed</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ac61b61d470a7a69ee987aee1a9c6c83">volume_master_connected</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#6463d7fcd5680168aebb6784587463be">node_connect</a> (<a class="el" href="structnode__def.html">node</a> nod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#1f8c9c59e43944fefe2c22fc468173ec">node_measure_connection_speed</a> (<a class="el" href="structthread__def.html">thread</a> *t, int fd, uint32_t sid, int32_t *r)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#736e262ccd8f1e7c496ed8f0dc0f3fdb">node_authenticate</a> (<a class="el" href="structthread__def.html">thread</a> *t, <a class="el" href="structnode__def.html">node</a> nod, <a class="el" href="network_8h.html#868c0a63d9198ca553df6bea18817a82">authentication_status</a> auth)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#836f7c0bcb74cfb28215cc8aaae5c834">node_connect_and_authenticate</a> (<a class="el" href="structthread__def.html">thread</a> *t, <a class="el" href="structnode__def.html">node</a> nod, <a class="el" href="network_8h.html#868c0a63d9198ca553df6bea18817a82">authentication_status</a> auth)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#0c932ef2b4e8ba33954e299dfce14003">request_from_this_node</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#744a729c9d088c0f4bb040836386c7ff">recycle_dc_to_fd_data</a> (<a class="el" href="structdata__coding__def.html">DC</a> *dc, <a class="el" href="structfd__data__def.html">fd_data_t</a> *fd_data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#63114b14f0a64bc57df529157a03ee60">recycle_dc_to_fd</a> (<a class="el" href="structdata__coding__def.html">DC</a> *dc, int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#d28de2eece208354fd185b548c9e4c9b">send_oneway_request</a> (<a class="el" href="structthread__def.html">thread</a> *t, int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#00240b13a2f01abf8bd1a8491e1adde0">send_request</a> (<a class="el" href="structthread__def.html">thread</a> *t, uint32_t <a class="el" href="zfs-prot_8c.html#2d443c7790532c952661166cf010cb17">request_id</a>, int fd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper function for sending request.  <a href="#00240b13a2f01abf8bd1a8491e1adde0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#da71e66146e80ef53af390ec9b189756">send_reply</a> (<a class="el" href="structthread__def.html">thread</a> *t)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#119a6a0439a602b8a1c51c710df04145">send_error_reply</a> (<a class="el" href="structthread__def.html">thread</a> *t, uint32_t <a class="el" href="zfs-prot_8c.html#2d443c7790532c952661166cf010cb17">request_id</a>, int32_t status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#01acacc9555a17163aec959e04ef0e4f">network_worker_init</a> (<a class="el" href="structthread__def.html">thread</a> *t)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#57dea47a481fa6a4c660674855d1d032">network_worker_cleanup</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#bc44a637de97cdc1010320dce29b5568">network_dispatch</a> (<a class="el" href="structfd__data__def.html">fd_data_t</a> *fd_data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#41b478bdc2c09ac3a1ec46a45e85f81e">network_main</a> (ATTRIBUTE_UNUSED void *data_)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#b02056483d16f3d062811f8cb18cce1e">fd_data_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize information about networking file descriptors, mutexes and cond vars.  <a href="#b02056483d16f3d062811f8cb18cce1e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#536a6d5f832633f319ae164266c274f1">fd_data_shutdown</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start networking shutdown.  <a href="#536a6d5f832633f319ae164266c274f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#1df20200bd3aafee88c381605c59d2f9">fd_data_destroy</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy networking and kernel file descriptors, mutexes and cond vars.  <a href="#1df20200bd3aafee88c381605c59d2f9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ea16bb421494dec59aa58bda38abc7be">network_start</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a listening socket and start the main network thread.  <a href="#ea16bb421494dec59aa58bda38abc7be"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#27e400186e95900585492202f501606a">network_cleanup</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Terminate network threads and destroy data structures.  <a href="#27e400186e95900585492202f501606a"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structthread__pool__def.html">thread_pool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#5a7fc260cfe02ed0b750942707cf4a85">network_pool</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#c4fa45a71d00ffd5e6c1fba6fbaa0bae">main_socket</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structfd__data__def.html">fd_data_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#968a4b6f8ee274080b42eae4c1fcfe59">fd_data_a</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="structfd__data__def.html">fd_data_t</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#fc96158f7b62d68f30b14d5bf5e148a9">active</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a4d4a8f5a320f5cf7608c41fd2f1ccc9">nactive</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static pthread_mutex_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#afbb9f2da2ed7ee0acd5b3e913aa6c9c">active_mutex</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#9528d09825e9e042f5444b59106ea84f">pending_slow_reqs_count</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of pending slow requests.  <a href="#9528d09825e9e042f5444b59106ea84f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">pthread_mutex_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#59a99d25ba5bffaa1855481f3d561d53">pending_slow_reqs_mutex</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mutex for <a class="el" href="network_8h.html#1213d448ab03c0805fd259234fd83dc5" title="Condition variable for pending_slow_reqs_count.">pending_slow_reqs_cond</a>.  <a href="#59a99d25ba5bffaa1855481f3d561d53"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">pthread_cond_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#1213d448ab03c0805fd259234fd83dc5">pending_slow_reqs_cond</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Condition variable for <a class="el" href="network_8h.html#9528d09825e9e042f5444b59106ea84f" title="Number of pending slow requests.">pending_slow_reqs_count</a>.  <a href="#1213d448ab03c0805fd259234fd83dc5"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Network thread functions. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="f13257efb2c2f048be8111da8e45ca74"></a><!-- doxytag: member="network.c::DEFINE_ZFS_PROC" ref="f13257efb2c2f048be8111da8e45ca74" args="(NUMBER, NAME, FUNCTION, ARGS, AUTH, CALL_MODE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFINE_ZFS_PROC          </td>
          <td>(</td>
          <td class="paramtype">NUMBER,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NAME,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FUNCTION,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ARGS,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AUTH,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CALL_MODE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d0be2a5b4bdceac3b131778e93ccc595"></a><!-- doxytag: member="network.c::ZFS_CALL_SERVER" ref="d0be2a5b4bdceac3b131778e93ccc595" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZFS_CALL_SERVER          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="14699d17ece2e57470a2600ce6a0d6ae"></a><!-- doxytag: member="network.c::add_fd_to_active" ref="14699d17ece2e57470a2600ce6a0d6ae" args="(int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_fd_to_active           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add file descriptor FD to the set of active file descriptors. 
</div>
</div><p>
<a class="anchor" name="546f6c3fb6ffc4d7c7a2788ad3bd2334"></a><!-- doxytag: member="network.c::close_active_fd" ref="546f6c3fb6ffc4d7c7a2788ad3bd2334" args="(int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void close_active_fd           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close an active file descriptor on index I in ACTIVE. 
</div>
</div><p>
<a class="anchor" name="01208284c3394d58d268d1394ad3d2a9"></a><!-- doxytag: member="network.c::close_network_fd" ref="01208284c3394d58d268d1394ad3d2a9" args="(int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_network_fd           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file descriptor FD and update its fd_data. 
</div>
</div><p>
<a class="anchor" name="1df20200bd3aafee88c381605c59d2f9"></a><!-- doxytag: member="network.c::fd_data_destroy" ref="1df20200bd3aafee88c381605c59d2f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fd_data_destroy           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy networking and kernel file descriptors, mutexes and cond vars. 
<p>

</div>
</div><p>
<a class="anchor" name="b02056483d16f3d062811f8cb18cce1e"></a><!-- doxytag: member="network.c::fd_data_init" ref="b02056483d16f3d062811f8cb18cce1e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fd_data_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize information about networking file descriptors, mutexes and cond vars. 
<p>

</div>
</div><p>
<a class="anchor" name="536a6d5f832633f319ae164266c274f1"></a><!-- doxytag: member="network.c::fd_data_shutdown" ref="536a6d5f832633f319ae164266c274f1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fd_data_shutdown           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start networking shutdown. 
<p>
Wake threads waiting for reply on file descriptors. 
</div>
</div><p>
<a class="anchor" name="aecb02d3fd18be9903ded6e573e99f10"></a><!-- doxytag: member="network.c::init_fd_data" ref="aecb02d3fd18be9903ded6e573e99f10" args="(int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void init_fd_data           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize data for file descriptor FD and add it to ACTIVE. 
</div>
</div><p>
<a class="anchor" name="27e400186e95900585492202f501606a"></a><!-- doxytag: member="network.c::network_cleanup" ref="27e400186e95900585492202f501606a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_cleanup           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Terminate network threads and destroy data structures. 
<p>

</div>
</div><p>
<a class="anchor" name="bc44a637de97cdc1010320dce29b5568"></a><!-- doxytag: member="network.c::network_dispatch" ref="bc44a637de97cdc1010320dce29b5568" args="(fd_data_t *fd_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool network_dispatch           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfd__data__def.html">fd_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>fd_data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function which gets a request and passes it to some network thread. It also regulates the number of network threads. 
</div>
</div><p>
<a class="anchor" name="41b478bdc2c09ac3a1ec46a45e85f81e"></a><!-- doxytag: member="network.c::network_main" ref="41b478bdc2c09ac3a1ec46a45e85f81e" args="(ATTRIBUTE_UNUSED void *data_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* network_main           </td>
          <td>(</td>
          <td class="paramtype">ATTRIBUTE_UNUSED void *&nbsp;</td>
          <td class="paramname"> <em>data_</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Main function of the main (i.e. listening) network thread. 
</div>
</div><p>
<a class="anchor" name="ea16bb421494dec59aa58bda38abc7be"></a><!-- doxytag: member="network.c::network_start" ref="ea16bb421494dec59aa58bda38abc7be" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool network_start           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a listening socket and start the main network thread. 
<p>

</div>
</div><p>
<a class="anchor" name="57dea47a481fa6a4c660674855d1d032"></a><!-- doxytag: member="network.c::network_worker_cleanup" ref="57dea47a481fa6a4c660674855d1d032" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_worker_cleanup           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Cleanup network thread DATA. 
</div>
</div><p>
<a class="anchor" name="01acacc9555a17163aec959e04ef0e4f"></a><!-- doxytag: member="network.c::network_worker_init" ref="01acacc9555a17163aec959e04ef0e4f" args="(thread *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_worker_init           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize network thread T. 
</div>
</div><p>
<a class="anchor" name="736e262ccd8f1e7c496ed8f0dc0f3fdb"></a><!-- doxytag: member="network.c::node_authenticate" ref="736e262ccd8f1e7c496ed8f0dc0f3fdb" args="(thread *t, node nod, authentication_status auth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int node_authenticate           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnode__def.html">node</a>&nbsp;</td>
          <td class="paramname"> <em>nod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="network_8h.html#868c0a63d9198ca553df6bea18817a82">authentication_status</a>&nbsp;</td>
          <td class="paramname"> <em>auth</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Authenticate connection with node NOD using data of thread T. On success leave NETWORK_FD_DATA[NOD-&gt;FD].MUTEX lcoked. 
</div>
</div><p>
<a class="anchor" name="6463d7fcd5680168aebb6784587463be"></a><!-- doxytag: member="network.c::node_connect" ref="6463d7fcd5680168aebb6784587463be" args="(node nod)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int node_connect           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnode__def.html">node</a>&nbsp;</td>
          <td class="paramname"> <em>nod</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Connect to node NOD, return open file descriptor. 
</div>
</div><p>
<a class="anchor" name="836f7c0bcb74cfb28215cc8aaae5c834"></a><!-- doxytag: member="network.c::node_connect_and_authenticate" ref="836f7c0bcb74cfb28215cc8aaae5c834" args="(thread *t, node nod, authentication_status auth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int node_connect_and_authenticate           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnode__def.html">node</a>&nbsp;</td>
          <td class="paramname"> <em>nod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="network_8h.html#868c0a63d9198ca553df6bea18817a82">authentication_status</a>&nbsp;</td>
          <td class="paramname"> <em>auth</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check whether node NOD is connected and authenticated. If not do so. Return open file descriptor and leave its NETWORK_FD_DATA locked. 
</div>
</div><p>
<a class="anchor" name="a13352611b8d3fccf9947ad576fb6644"></a><!-- doxytag: member="network.c::node_connected" ref="a13352611b8d3fccf9947ad576fb6644" args="(uint32_t sid, unsigned int *generation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool node_connected           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>generation</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
If node SID is connected return true and store generation of file descriptor to GENERATION. Otherwise return false. 
</div>
</div><p>
<a class="anchor" name="da5d5652301ebe83082f39bcf4b8d9cd"></a><!-- doxytag: member="network.c::node_has_valid_fd" ref="da5d5652301ebe83082f39bcf4b8d9cd" args="(node nod)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool node_has_valid_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnode__def.html">node</a>&nbsp;</td>
          <td class="paramname"> <em>nod</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if there is a valid file descriptor attached to node NOD and lock NETWORK_FD_DATA[NOD-&gt;FD].MUTEX. This function expects NOD-&gt;MUTEX to be locked. 
</div>
</div><p>
<a class="anchor" name="1f8c9c59e43944fefe2c22fc468173ec"></a><!-- doxytag: member="network.c::node_measure_connection_speed" ref="1f8c9c59e43944fefe2c22fc468173ec" args="(thread *t, int fd, uint32_t sid, int32_t *r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool node_measure_connection_speed           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&nbsp;</td>
          <td class="paramname"> <em>r</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Measure connection speed of node with ID SID connected through file descriptor FD. 
</div>
</div><p>
<a class="anchor" name="63114b14f0a64bc57df529157a03ee60"></a><!-- doxytag: member="network.c::recycle_dc_to_fd" ref="63114b14f0a64bc57df529157a03ee60" args="(DC *dc, int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recycle_dc_to_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdata__coding__def.html">DC</a> *&nbsp;</td>
          <td class="paramname"> <em>dc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put DC back to data for socket connected to master of volume VOL. 
</div>
</div><p>
<a class="anchor" name="744a729c9d088c0f4bb040836386c7ff"></a><!-- doxytag: member="network.c::recycle_dc_to_fd_data" ref="744a729c9d088c0f4bb040836386c7ff" args="(DC *dc, fd_data_t *fd_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recycle_dc_to_fd_data           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdata__coding__def.html">DC</a> *&nbsp;</td>
          <td class="paramname"> <em>dc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfd__data__def.html">fd_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>fd_data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put DC back to file descriptor data FD_DATA. 
</div>
</div><p>
<a class="anchor" name="0c932ef2b4e8ba33954e299dfce14003"></a><!-- doxytag: member="network.c::request_from_this_node" ref="0c932ef2b4e8ba33954e299dfce14003" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool request_from_this_node           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if current request came from this node. 
</div>
</div><p>
<a class="anchor" name="119a6a0439a602b8a1c51c710df04145"></a><!-- doxytag: member="network.c::send_error_reply" ref="119a6a0439a602b8a1c51c710df04145" args="(thread *t, uint32_t request_id, int32_t status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void send_error_reply           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>request_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>status</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send error reply with error status STATUS. 
</div>
</div><p>
<a class="anchor" name="d28de2eece208354fd185b548c9e4c9b"></a><!-- doxytag: member="network.c::send_oneway_request" ref="d28de2eece208354fd185b548c9e4c9b" args="(thread *t, int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_oneway_request           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send one-way request with request id REQUEST_ID using data in thread T to connected socket FD. 
</div>
</div><p>
<a class="anchor" name="da71e66146e80ef53af390ec9b189756"></a><!-- doxytag: member="network.c::send_reply" ref="da71e66146e80ef53af390ec9b189756" args="(thread *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void send_reply           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a reply. 
</div>
</div><p>
<a class="anchor" name="00240b13a2f01abf8bd1a8491e1adde0"></a><!-- doxytag: member="network.c::send_request" ref="00240b13a2f01abf8bd1a8491e1adde0" args="(thread *t, uint32_t request_id, int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_request           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__def.html">thread</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>request_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper function for sending request. 
<p>
Send request with request id REQUEST_ID using data in thread T to connected socket FD and wait for reply. It expects fd_data_a[fd].mutex to be locked. Tracks number of slow requests in <a class="el" href="network_8h.html#9528d09825e9e042f5444b59106ea84f" title="Number of pending slow requests.">pending_slow_reqs_count</a> for slowly connected volumes. 
</div>
</div><p>
<a class="anchor" name="0ec9e7d253e53484c6965f99845e7ba0"></a><!-- doxytag: member="network.c::update_node_fd" ref="0ec9e7d253e53484c6965f99845e7ba0" args="(node nod, int fd, unsigned int generation, bool active_open)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_node_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnode__def.html">node</a>&nbsp;</td>
          <td class="paramname"> <em>nod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>generation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>active_open</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update file descriptor of node NOD to be FD with generation GENERATION. ACTIVE_OPEN is true when this node is creating the connection. 
</div>
</div><p>
<a class="anchor" name="ac61b61d470a7a69ee987aee1a9c6c83"></a><!-- doxytag: member="network.c::volume_master_connected" ref="ac61b61d470a7a69ee987aee1a9c6c83" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="zfs-prot_8h.html#9e8c56217c02c355396741e69be2422a">connection_speed</a> volume_master_connected           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the speed of connection between current node and master of volume VOL. 
</div>
</div><p>
<a class="anchor" name="b05e13e2874f423b317be094e6b343d4"></a><!-- doxytag: member="network.c::waiting4reply_eq" ref="b05e13e2874f423b317be094e6b343d4" args="(const void *xx, const void *yy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int waiting4reply_eq           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>yy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true when waiting4reply_data XX is data for request ID *YY. 
</div>
</div><p>
<a class="anchor" name="5dfe1a1b5d917369b28a28a0dc916f5d"></a><!-- doxytag: member="network.c::waiting4reply_hash" ref="5dfe1a1b5d917369b28a28a0dc916f5d" args="(const void *xx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hashtab_8h.html#fb05a131363b0de134535fc5f7b01dc0">hash_t</a> waiting4reply_hash           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>xx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hash function for waiting4reply_data. 
</div>
</div><p>
<a class="anchor" name="d69b54caf868fa84a6a166482f284837"></a><!-- doxytag: member="network.c::wake_all_threads" ref="d69b54caf868fa84a6a166482f284837" args="(fd_data_t *fd_data, int32_t retval)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wake_all_threads           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfd__data__def.html">fd_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>fd_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>retval</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Wake all threads waiting for reply on file descriptor with fd_data FD_DATA and set return value to RETVAL. 
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="fc96158f7b62d68f30b14d5bf5e148a9"></a><!-- doxytag: member="network.c::active" ref="fc96158f7b62d68f30b14d5bf5e148a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfd__data__def.html">fd_data_t</a>** <a class="el" href="network_8c.html#fc96158f7b62d68f30b14d5bf5e148a9">active</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Array of pointers to data of active file descriptors. 
</div>
</div><p>
<a class="anchor" name="afbb9f2da2ed7ee0acd5b3e913aa6c9c"></a><!-- doxytag: member="network.c::active_mutex" ref="afbb9f2da2ed7ee0acd5b3e913aa6c9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t <a class="el" href="network_8c.html#afbb9f2da2ed7ee0acd5b3e913aa6c9c">active_mutex</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mutex protecting access to ACTIVE and NACTIVE. 
</div>
</div><p>
<a class="anchor" name="968a4b6f8ee274080b42eae4c1fcfe59"></a><!-- doxytag: member="network.c::fd_data_a" ref="968a4b6f8ee274080b42eae4c1fcfe59" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfd__data__def.html">fd_data_t</a>* <a class="el" href="network_8h.html#968a4b6f8ee274080b42eae4c1fcfe59">fd_data_a</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The array of data for each file descriptor. 
</div>
</div><p>
<a class="anchor" name="c4fa45a71d00ffd5e6c1fba6fbaa0bae"></a><!-- doxytag: member="network.c::main_socket" ref="c4fa45a71d00ffd5e6c1fba6fbaa0bae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="network_8c.html#c4fa45a71d00ffd5e6c1fba6fbaa0bae">main_socket</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
File descriptor of the main (i.e. listening) socket. 
</div>
</div><p>
<a class="anchor" name="a4d4a8f5a320f5cf7608c41fd2f1ccc9"></a><!-- doxytag: member="network.c::nactive" ref="a4d4a8f5a320f5cf7608c41fd2f1ccc9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="network_8c.html#a4d4a8f5a320f5cf7608c41fd2f1ccc9">nactive</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of active file descriptors. 
</div>
</div><p>
<a class="anchor" name="5a7fc260cfe02ed0b750942707cf4a85"></a><!-- doxytag: member="network.c::network_pool" ref="5a7fc260cfe02ed0b750942707cf4a85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structthread__pool__def.html">thread_pool</a> <a class="el" href="network_8h.html#5a7fc260cfe02ed0b750942707cf4a85">network_pool</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pool of network threads. 
</div>
</div><p>
<a class="anchor" name="1213d448ab03c0805fd259234fd83dc5"></a><!-- doxytag: member="network.c::pending_slow_reqs_cond" ref="1213d448ab03c0805fd259234fd83dc5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_cond_t <a class="el" href="network_8h.html#1213d448ab03c0805fd259234fd83dc5">pending_slow_reqs_cond</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Condition variable for <a class="el" href="network_8h.html#9528d09825e9e042f5444b59106ea84f" title="Number of pending slow requests.">pending_slow_reqs_count</a>. 
<p>
Protected by <a class="el" href="network_8h.html#59a99d25ba5bffaa1855481f3d561d53" title="Mutex for pending_slow_reqs_cond.">pending_slow_reqs_mutex</a> 
</div>
</div><p>
<a class="anchor" name="9528d09825e9e042f5444b59106ea84f"></a><!-- doxytag: member="network.c::pending_slow_reqs_count" ref="9528d09825e9e042f5444b59106ea84f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="network_8h.html#9528d09825e9e042f5444b59106ea84f">pending_slow_reqs_count</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of pending slow requests. 
<p>
Total number of RPC requests sent and yet not received from slowly connected nodes.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="network_8h.html#1213d448ab03c0805fd259234fd83dc5" title="Condition variable for pending_slow_reqs_count.">pending_slow_reqs_cond</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="59a99d25ba5bffaa1855481f3d561d53"></a><!-- doxytag: member="network.c::pending_slow_reqs_mutex" ref="59a99d25ba5bffaa1855481f3d561d53" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t <a class="el" href="network_8h.html#59a99d25ba5bffaa1855481f3d561d53">pending_slow_reqs_mutex</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mutex for <a class="el" href="network_8h.html#1213d448ab03c0805fd259234fd83dc5" title="Condition variable for pending_slow_reqs_count.">pending_slow_reqs_cond</a>. 
<p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 6 00:39:38 2010 for zlomekFS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
