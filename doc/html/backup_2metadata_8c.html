<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>zlomekFS: metadata.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_21c430ab3b7001ae39034eae6f7edf71.html">zfsd</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_ac94841c51e61ddc7acc56e12a771012.html">backup</a></div>
<h1>backup/metadata.c File Reference</h1>Metadata management functions. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="backup_2system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;inttypes.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &quot;<a class="el" href="backup_2pthread-wrapper_8h-source.html">pthread-wrapper.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2metadata_8h-source.html">metadata.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2constant_8h-source.html">constant.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2memory_8h-source.html">memory.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2crc32_8h-source.html">crc32.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2interval_8h-source.html">interval.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2varray_8h-source.html">varray.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2hardlink-list_8h-source.html">hardlink-list.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2journal_8h-source.html">journal.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2fh_8h-source.html">fh.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2volume_8h-source.html">volume.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2config_8h-source.html">config.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2fibheap_8h-source.html">fibheap.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2util_8h-source.html">util.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2data-coding_8h-source.html">data-coding.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2hashfile_8h-source.html">hashfile.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2zfs-prot_8h-source.html">zfs-prot.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="backup_2user-group_8h-source.html">user-group.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_def</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data for file descriptor.  <a href="structmetadata__fd__data__def.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#40745031bae02c7246080e20cb757564">METADATA_HASH</a>(M)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#ed750404198b179b6df4c4df428f0f7c">FH_MAPPING_HASH</a>(M)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#82b206f761fe261a328ededaee15ab49">fh_mapping_decode</a>&nbsp;&nbsp;&nbsp;NULL</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#d21668d2cc454231567d38b33b578511">fh_mapping_encode</a>&nbsp;&nbsp;&nbsp;NULL</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef <a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_def</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#99e6e885abb1922ef1f92f034d0472e5">metadata_fd_data_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data for file descriptor.  <a href="#99e6e885abb1922ef1f92f034d0472e5"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#8072d01b291899dd3fac3db5666afb66">init_metadata_for_created_volume_root</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#bfba20ade41d07bca98eed4ca1986f57">read_hardlinks_file</a> (<a class="el" href="structhardlink__list__def.html">hardlink_list</a> sl, int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#cab1fabbc001fa63043bd3078a18df97">delete_hardlinks_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#b5ffc171cf1357ceb1ec98d6c448245f">write_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structhardlink__list__def.html">hardlink_list</a> hl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#a2f8c98f291f07e359e54e823f6c711e">metadata_hash</a> (const void *x)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#546ae02aa9b6fa4eff2db0ffd01aaa54">metadata_eq</a> (const void *x, const void *y)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#afff2efcb110d3aa0d4f14e432e94270">fh_mapping_hash</a> (const void *x)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#c2b2411af9fdc597ea1a24316f93e3e8">fh_mapping_eq</a> (const void *x, const void *y)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#05216fe7623c95e291a15869d5ad57f2">build_metadata_path</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#dcfb2d4d9334eb819ae9b5bd6e85477d">build_fh_metadata_path</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, unsigned int tree_depth)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#1a5693b4c8bfc3e3a5c680d84ce17122">build_shadow_metadata_path</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structstring__def.html">string</a> *file_name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#e1c6a96619247683cb39fcfc4afb8836">create_path_for_file</a> (<a class="el" href="structstring__def.html">string</a> *file, unsigned int mode, <a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#d873aea7ee86f752791483687c444ac1">remove_file_and_path</a> (<a class="el" href="structstring__def.html">string</a> *file, unsigned int tree_depth)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#a61de3a0dbfd4076dfa12a11951f13a1">hashfile_opened_p</a> (<a class="el" href="structhfile__def.html">hfile_t</a> hfile)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#da0a8d37ec3b14615265f4621bfea2f0">interval_opened_p</a> (<a class="el" href="structinterval__tree__def.html">interval_tree</a> tree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#96a90b0f5e0221e51277ad6a732213aa">journal_opened_p</a> (<a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#b2306a6c388eab914816b4baae3ff62c">init_hashfile_fd</a> (<a class="el" href="structhfile__def.html">hfile_t</a> hfile)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#ce91ebc8b197c6b6ee36dbf7990f3ffe">init_interval_fd</a> (<a class="el" href="structinterval__tree__def.html">interval_tree</a> tree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#da94906a5a608ccbce879dcd37c6d3fd">init_journal_fd</a> (<a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#4027c10af26d44c4b613aae2ddb2f39c">close_metadata_fd</a> (int fd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#e337e4328e6a09aa5e7f5af408a4d405">open_metadata</a> (const char *pathname, int flags, mode_t mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#646ca4ad8fb8911413174c50d1857d9e">open_fh_metadata</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, int flags, mode_t mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#8d861c333b9d67323a2744f8931246d5">open_hash_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#c70af35adcb1f6604b7ab05bc4231cd3">open_interval_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#2f1a32bb3cdb92ff0934b3b5d4fd811e">open_journal_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#adb6ee5a42b002a1c3c2f1b4d9abe9f4">delete_useless_interval_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, <a class="el" href="structinterval__tree__def.html">interval_tree</a> tree, <a class="el" href="structstring__def.html">string</a> *path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#4ea45c42af48ca027ace893b4fc33ff1">flush_interval_tree_1</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, <a class="el" href="structstring__def.html">string</a> *path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="zfs-prot_8h.html#fd6f88a62c177fab51044d30a2bc4587">ftype</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#cca3aa646269f83054c58b6ca1a53b7f">zfs_mode_to_ftype</a> (uint32_t mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#1bd74b569275131df722d300d754e43b">init_volume_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#87da9132e9e7126d40dc50f244b503b7">close_hash_file</a> (<a class="el" href="structhfile__def.html">hfile_t</a> hfile)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#309a7771f53cdf846bf361559dd4774c">close_volume_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#7310c189acd2b5398864012f4fe8a48a">close_interval_file</a> (<a class="el" href="structinterval__tree__def.html">interval_tree</a> tree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#2dc9d9eea2254d262d8c98b3dfced2cd">close_journal_file</a> (<a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#2a06c116c80b124859bdc94fd93ded47">init_interval_tree</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#acf9c322b0e516c9684f67d2daaed9d1">flush_interval_tree</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#8025dd9851d0d4e6f42c111dcb23b7be">free_interval_tree</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#65345a169c527832eb9533c81d419d3e">append_interval</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a> type, uint64_t start, uint64_t end)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#9b5f2db967551a3e834b9b2aa973554f">set_attr_version</a> (<a class="el" href="structfattr__def.html">fattr</a> *attr, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#a6db1869c9245582c4cad2ec5f3dfdbf">lookup_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, bool <a class="el" href="backup_2hashtab_8h.html#0643c315e50716d291891390d21527ea">insert</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#d2ea3c7de573fc6f1d7dc66a69d6fe83">get_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#358490cdfc16bc84cf107885087d98f6">delete_fh_mapping</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structfh__mapping__def.html">fh_mapping</a> *map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#443d6b92e7a0693e943650e0e276decf">get_fh_mapping_for_master_fh</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh, <a class="el" href="structfh__mapping__def.html">fh_mapping</a> *map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#58f86881a12b09f757eff3241615ea2d">flush_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#592bd1089b07aefa0a78331e28d15004">set_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, uint32_t flags, uint64_t local_version, uint64_t master_version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#6f233b6f69a1cdcb8173d7bfbb2ccbab">set_metadata_flags</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, uint32_t flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#93fbef76cf9854a4544d6fb002cf29c0">set_metadata_master_fh</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#897bd01c8723d93be02c6b630a32c497">inc_local_version</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#a1cd65ebea4df0e0e9f4f9bc5fb3912c">inc_local_version_and_modified</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#85c5601fec008dc29019077393ec9506">delete_metadata</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t dev, uint32_t ino, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#97aad1538e86290b320767a0d6480d19">delete_metadata_of_created_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#976d00e136b8bd8d1a9649593a09c697">load_interval_trees</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#61e7d7f277cd3c4caf628287c8e508c2">save_interval_trees</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structinternal__fh__def.html">internal_fh</a> fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#5a6a2d1f14b618684073f051fa406056">write_hardlinks_file</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structhardlink__list__def.html">hardlink_list</a> hl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#518c9b4dbad8f0c6a586a469148a10a3">read_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structhardlink__list__def.html">hardlink_list</a> hl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#24a97564272128df1634ba54c890c594">metadata_hardlink_insert</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#9afd87ae1e63ab84565a636402d3ce87">metadata_hardlink_replace</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t old_parent_dev, uint32_t old_parent_ino, <a class="el" href="structstring__def.html">string</a> *old_name, uint32_t new_parent_dev, uint32_t new_parent_ino, <a class="el" href="structstring__def.html">string</a> *new_name, bool shadow)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#67f5457a19aa44cb6ef37dfc9b5af2af">metadata_hardlink_set</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, uint32_t parent_dev, uint32_t parent_ino, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#8aa2d9597003dbf4b52e8df0acbb0d71">metadata_n_hardlinks</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#09c2cc02c843bcc92e776cf3f63f9ea5">get_local_path_from_metadata</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#fe2149b046da40b419c5792b3722df5a">flush_journal</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structstring__def.html">string</a> *path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#9785edb2815efbcd6f2a52169997151e">read_journal</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#ef49d0ce915f8bc578649f4ece027342">write_journal</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structjournal__def.html">journal_t</a> journal)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#31ca0ee68a26321afbe6dd39d1b2e117">add_journal_entry</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *local_fh, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *master_fh, uint64_t master_version, <a class="el" href="structstring__def.html">string</a> *name, <a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a> oper)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#911d4e4e10147ecbf55f7d921d2f0d71">add_journal_entry_meta</a> (<a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structjournal__def.html">journal_t</a> journal, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structmetadata__def.html">metadata</a> *meta, <a class="el" href="structstring__def.html">string</a> *name, <a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a> oper)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#bbb4ba5f042b5630bb1bb14735c8026f">create_shadow_path</a> (<a class="el" href="structstring__def.html">string</a> *path, <a class="el" href="structvolume__def.html">volume</a> vol, <a class="el" href="structzfs__fh__def.html">zfs_fh</a> *fh, <a class="el" href="structstring__def.html">string</a> *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#8409ce6494102bda76a0b2a2e1e210c0">initialize_metadata_c</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#3ada2ea3ac4856cb87415dbed528adc1">cleanup_metadata_c</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#0897dc5e6757cea8fad80b1c414dee72">metadata_tree_depth</a> = 1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#cc7d96ba668e6c108a83f7cf8b1e5615">metadata_fd_data</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="structfibheap__def.html">fibheap</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#1b5fdef37b8061a83f65a7bd19dab2ac">metadata_heap</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static pthread_mutex_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="backup_2metadata_8c.html#f6426de7676d5ef61b8b8ef79ac00b53">metadata_mutex</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Metadata management functions. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="82b206f761fe261a328ededaee15ab49"></a><!-- doxytag: member="backup/metadata.c::fh_mapping_decode" ref="82b206f761fe261a328ededaee15ab49" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define fh_mapping_decode&nbsp;&nbsp;&nbsp;NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d21668d2cc454231567d38b33b578511"></a><!-- doxytag: member="backup/metadata.c::fh_mapping_encode" ref="d21668d2cc454231567d38b33b578511" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define fh_mapping_encode&nbsp;&nbsp;&nbsp;NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ed750404198b179b6df4c4df428f0f7c"></a><!-- doxytag: member="backup/metadata.c::FH_MAPPING_HASH" ref="ed750404198b179b6df4c4df428f0f7c" args="(M)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FH_MAPPING_HASH          </td>
          <td>(</td>
          <td class="paramtype">M&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(<a class="code" href="backup_2crc32_8c.html#a4e5598af82ca76082574ea3e85bc84e">crc32_update</a> (<a class="code" href="backup_2crc32_8c.html#c8f920de0cb519e35ff1e3a4ada446ae">crc32_buffer</a> (&amp;(M).master_fh.dev, \
                                                        sizeof (uint32_t)), \
                                          &amp;(M).master_fh.ino,               \
                                          sizeof (uint32_t)))
</pre></div>Hash function for file handle mapping M. 
</div>
</div><p>
<a class="anchor" name="40745031bae02c7246080e20cb757564"></a><!-- doxytag: member="backup/metadata.c::METADATA_HASH" ref="40745031bae02c7246080e20cb757564" args="(M)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METADATA_HASH          </td>
          <td>(</td>
          <td class="paramtype">M&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(<a class="code" href="backup_2crc32_8c.html#a4e5598af82ca76082574ea3e85bc84e">crc32_update</a> (<a class="code" href="backup_2crc32_8c.html#c8f920de0cb519e35ff1e3a4ada446ae">crc32_buffer</a> (&amp;(M).dev,            \
                                                      <span class="keyword">sizeof</span> (uint32_t)), \
                                        &amp;(M).ino, <span class="keyword">sizeof</span> (uint32_t)))
</pre></div>Hash function for metadata M. 
</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="99e6e885abb1922ef1f92f034d0472e5"></a><!-- doxytag: member="backup/metadata.c::metadata_fd_data_t" ref="99e6e885abb1922ef1f92f034d0472e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_def</a>  <a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Data for file descriptor. 
<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="31ca0ee68a26321afbe6dd39d1b2e117"></a><!-- doxytag: member="backup/metadata.c::add_journal_entry" ref="31ca0ee68a26321afbe6dd39d1b2e117" args="(volume vol, journal_t journal, zfs_fh *fh, zfs_fh *local_fh, zfs_fh *master_fh, uint64_t master_version, string *name, journal_operation_t oper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool add_journal_entry           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>local_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>master_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a>&nbsp;</td>
          <td class="paramname"> <em>oper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a journal entry with key [LOCAL_FH, NAME], master file handle MASTER_FH, master version MASTER_VERSION and operation OPER to journal JOURNAL for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="911d4e4e10147ecbf55f7d921d2f0d71"></a><!-- doxytag: member="backup/metadata.c::add_journal_entry_meta" ref="911d4e4e10147ecbf55f7d921d2f0d71" args="(volume vol, journal_t journal, zfs_fh *fh, metadata *meta, string *name, journal_operation_t oper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool add_journal_entry_meta           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="journal_8h.html#1f70a09ba560f8046f05a1aed1521e0b">journal_operation_t</a>&nbsp;</td>
          <td class="paramname"> <em>oper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a journal entry for file with metadata META, name NAME and operation OPER to journal JOURNAL for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="65345a169c527832eb9533c81d419d3e"></a><!-- doxytag: member="backup/metadata.c::append_interval" ref="65345a169c527832eb9533c81d419d3e" args="(volume vol, internal_fh fh, metadata_type type, uint64_t start, uint64_t end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool append_interval           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the interval [START, END) to the end of interval file of type TYPE for file handle FH on volume VOL. Open the interval file for appending when it is not opened. 
</div>
</div><p>
<a class="anchor" name="dcfb2d4d9334eb819ae9b5bd6e85477d"></a><!-- doxytag: member="backup/metadata.c::build_fh_metadata_path" ref="dcfb2d4d9334eb819ae9b5bd6e85477d" args="(string *path, volume vol, zfs_fh *fh, metadata_type type, unsigned int tree_depth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void build_fh_metadata_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>tree_depth</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build path to file with metadata of type TYPE for file handle FH on volume VOL, the depth of metadata directory tree is TREE_DEPTH. 
</div>
</div><p>
<a class="anchor" name="05216fe7623c95e291a15869d5ad57f2"></a><!-- doxytag: member="backup/metadata.c::build_metadata_path" ref="05216fe7623c95e291a15869d5ad57f2" args="(string *path, volume vol, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void build_metadata_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build path to file with global metadata of type TYPE for volume VOL. 
</div>
</div><p>
<a class="anchor" name="1a5693b4c8bfc3e3a5c680d84ce17122"></a><!-- doxytag: member="backup/metadata.c::build_shadow_metadata_path" ref="1a5693b4c8bfc3e3a5c680d84ce17122" args="(string *path, volume vol, zfs_fh *fh, string *file_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void build_shadow_metadata_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>file_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build path PATH to shadow file for file FH with name FILE_NAME on volume VOL. 
</div>
</div><p>
<a class="anchor" name="3ada2ea3ac4856cb87415dbed528adc1"></a><!-- doxytag: member="backup/metadata.c::cleanup_metadata_c" ref="3ada2ea3ac4856cb87415dbed528adc1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_metadata_c           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy data structures in METADATA.C. 
</div>
</div><p>
<a class="anchor" name="87da9132e9e7126d40dc50f244b503b7"></a><!-- doxytag: member="backup/metadata.c::close_hash_file" ref="87da9132e9e7126d40dc50f244b503b7" args="(hfile_t hfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void close_hash_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhfile__def.html">hfile_t</a>&nbsp;</td>
          <td class="paramname"> <em>hfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file for hahs file HFILE. 
</div>
</div><p>
<a class="anchor" name="7310c189acd2b5398864012f4fe8a48a"></a><!-- doxytag: member="backup/metadata.c::close_interval_file" ref="7310c189acd2b5398864012f4fe8a48a" args="(interval_tree tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_interval_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterval__tree__def.html">interval_tree</a>&nbsp;</td>
          <td class="paramname"> <em>tree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file for interval tree TREE. 
</div>
</div><p>
<a class="anchor" name="2dc9d9eea2254d262d8c98b3dfced2cd"></a><!-- doxytag: member="backup/metadata.c::close_journal_file" ref="2dc9d9eea2254d262d8c98b3dfced2cd" args="(journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_journal_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file for journal JOURNAL. 
</div>
</div><p>
<a class="anchor" name="4027c10af26d44c4b613aae2ddb2f39c"></a><!-- doxytag: member="backup/metadata.c::close_metadata_fd" ref="4027c10af26d44c4b613aae2ddb2f39c" args="(int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void close_metadata_fd           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close file descriptor FD of metadata file. 
</div>
</div><p>
<a class="anchor" name="309a7771f53cdf846bf361559dd4774c"></a><!-- doxytag: member="backup/metadata.c::close_volume_metadata" ref="309a7771f53cdf846bf361559dd4774c" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close_volume_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close hash file containing metadata for volume VOL. 
</div>
</div><p>
<a class="anchor" name="e1c6a96619247683cb39fcfc4afb8836"></a><!-- doxytag: member="backup/metadata.c::create_path_for_file" ref="e1c6a96619247683cb39fcfc4afb8836" args="(string *file, unsigned int mode, volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool create_path_for_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a full path to file FILE with access rights MODE. Return true if path exists at the end of this function. If VOL is not NULL we are creating a shadow tree on volume VOL so insert metadata for new directories. 
</div>
</div><p>
<a class="anchor" name="bbb4ba5f042b5630bb1bb14735c8026f"></a><!-- doxytag: member="backup/metadata.c::create_shadow_path" ref="bbb4ba5f042b5630bb1bb14735c8026f" args="(string *path, volume vol, zfs_fh *fh, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool create_shadow_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build and create path PATH to shadow file for file FH with name NAME on volume VOL. 
</div>
</div><p>
<a class="anchor" name="358490cdfc16bc84cf107885087d98f6"></a><!-- doxytag: member="backup/metadata.c::delete_fh_mapping" ref="358490cdfc16bc84cf107885087d98f6" args="(volume vol, fh_mapping *map)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool delete_fh_mapping           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfh__mapping__def.html">fh_mapping</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete file handle mapping MAP on volume VOL. 
</div>
</div><p>
<a class="anchor" name="cab1fabbc001fa63043bd3078a18df97"></a><!-- doxytag: member="backup/metadata.c::delete_hardlinks_file" ref="cab1fabbc001fa63043bd3078a18df97" args="(volume vol, zfs_fh *fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void delete_hardlinks_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete list of hardlinks of ZFS file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="85c5601fec008dc29019077393ec9506"></a><!-- doxytag: member="backup/metadata.c::delete_metadata" ref="85c5601fec008dc29019077393ec9506" args="(volume vol, metadata *meta, uint32_t dev, uint32_t ino, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool delete_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete all metadata files for file on volume VOL with device DEV and inode INO and hardlink [PARENT_DEV, PARENT_INO, NAME]. 
</div>
</div><p>
<a class="anchor" name="97aad1538e86290b320767a0d6480d19"></a><!-- doxytag: member="backup/metadata.c::delete_metadata_of_created_file" ref="97aad1538e86290b320767a0d6480d19" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool delete_metadata_of_created_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete master fh and fh mapping for newly created file FH with metadata META on volume VOL. 
</div>
</div><p>
<a class="anchor" name="adb6ee5a42b002a1c3c2f1b4d9abe9f4"></a><!-- doxytag: member="backup/metadata.c::delete_useless_interval_file" ref="adb6ee5a42b002a1c3c2f1b4d9abe9f4" args="(volume vol, internal_fh fh, metadata_type type, interval_tree tree, string *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool delete_useless_interval_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinterval__tree__def.html">interval_tree</a>&nbsp;</td>
          <td class="paramname"> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete interval file PATH for interval tree TREE of type TYPE for internal file handle FH on volume VOL. Return true if it was useless. 
</div>
</div><p>
<a class="anchor" name="c2b2411af9fdc597ea1a24316f93e3e8"></a><!-- doxytag: member="backup/metadata.c::fh_mapping_eq" ref="c2b2411af9fdc597ea1a24316f93e3e8" args="(const void *x, const void *y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int fh_mapping_eq           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>y</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare element X of hash file with possible element Y. 
</div>
</div><p>
<a class="anchor" name="afff2efcb110d3aa0d4f14e432e94270"></a><!-- doxytag: member="backup/metadata.c::fh_mapping_hash" ref="afff2efcb110d3aa0d4f14e432e94270" args="(const void *x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a> fh_mapping_hash           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hash function for fh_mapping X. 
</div>
</div><p>
<a class="anchor" name="acf9c322b0e516c9684f67d2daaed9d1"></a><!-- doxytag: member="backup/metadata.c::flush_interval_tree" ref="acf9c322b0e516c9684f67d2daaed9d1" args="(volume vol, internal_fh fh, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool flush_interval_tree           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flush the interval tree of type TYPE for file handle FH on volume VOL to file. 
</div>
</div><p>
<a class="anchor" name="4ea45c42af48ca027ace893b4fc33ff1"></a><!-- doxytag: member="backup/metadata.c::flush_interval_tree_1" ref="4ea45c42af48ca027ace893b4fc33ff1" args="(volume vol, internal_fh fh, metadata_type type, string *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool flush_interval_tree_1           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flush interval tree of type TYPE for file handle FH on volume VOL to file PATH. 
</div>
</div><p>
<a class="anchor" name="fe2149b046da40b419c5792b3722df5a"></a><!-- doxytag: member="backup/metadata.c::flush_journal" ref="fe2149b046da40b419c5792b3722df5a" args="(volume vol, zfs_fh *fh, journal_t journal, string *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool flush_journal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the journal JOURNAL for file handle FH on volume VOL to file PATH or delete the file if the journal is empty. 
</div>
</div><p>
<a class="anchor" name="58f86881a12b09f757eff3241615ea2d"></a><!-- doxytag: member="backup/metadata.c::flush_metadata" ref="58f86881a12b09f757eff3241615ea2d" args="(volume vol, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool flush_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the metadata META to list file on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="8025dd9851d0d4e6f42c111dcb23b7be"></a><!-- doxytag: member="backup/metadata.c::free_interval_tree" ref="8025dd9851d0d4e6f42c111dcb23b7be" args="(volume vol, internal_fh fh, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool free_interval_tree           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flush the interval tree of type TYPE for file handle FH on volume VOL to file and free the interval tree. 
</div>
</div><p>
<a class="anchor" name="443d6b92e7a0693e943650e0e276decf"></a><!-- doxytag: member="backup/metadata.c::get_fh_mapping_for_master_fh" ref="443d6b92e7a0693e943650e0e276decf" args="(volume vol, zfs_fh *master_fh, fh_mapping *map)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool get_fh_mapping_for_master_fh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfh__mapping__def.html">fh_mapping</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get file handle mapping for master file handle MASTER_FH on volume VOL and store it to MAP. 
</div>
</div><p>
<a class="anchor" name="09c2cc02c843bcc92e776cf3f63f9ea5"></a><!-- doxytag: member="backup/metadata.c::get_local_path_from_metadata" ref="09c2cc02c843bcc92e776cf3f63f9ea5" args="(string *path, volume vol, zfs_fh *fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_local_path_from_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a local path for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="d2ea3c7de573fc6f1d7dc66a69d6fe83"></a><!-- doxytag: member="backup/metadata.c::get_metadata" ref="d2ea3c7de573fc6f1d7dc66a69d6fe83" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool get_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get metadata for file handle FH on volume VOL. Store the metadata to META and update FH-&gt;GEN. Unlock the volume. 
</div>
</div><p>
<a class="anchor" name="a61de3a0dbfd4076dfa12a11951f13a1"></a><!-- doxytag: member="backup/metadata.c::hashfile_opened_p" ref="a61de3a0dbfd4076dfa12a11951f13a1" args="(hfile_t hfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool hashfile_opened_p           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhfile__def.html">hfile_t</a>&nbsp;</td>
          <td class="paramname"> <em>hfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Is the hash file HFILE opened? 
</div>
</div><p>
<a class="anchor" name="897bd01c8723d93be02c6b630a32c497"></a><!-- doxytag: member="backup/metadata.c::inc_local_version" ref="897bd01c8723d93be02c6b630a32c497" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool inc_local_version           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Increase the local version for file FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="a1cd65ebea4df0e0e9f4f9bc5fb3912c"></a><!-- doxytag: member="backup/metadata.c::inc_local_version_and_modified" ref="a1cd65ebea4df0e0e9f4f9bc5fb3912c" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool inc_local_version_and_modified           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Increase the local version for file FH on volume VOL and set MODIFIED flag. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="b2306a6c388eab914816b4baae3ff62c"></a><!-- doxytag: member="backup/metadata.c::init_hashfile_fd" ref="b2306a6c388eab914816b4baae3ff62c" args="(hfile_t hfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void init_hashfile_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhfile__def.html">hfile_t</a>&nbsp;</td>
          <td class="paramname"> <em>hfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize file descriptor for hash file HFILE. 
</div>
</div><p>
<a class="anchor" name="ce91ebc8b197c6b6ee36dbf7990f3ffe"></a><!-- doxytag: member="backup/metadata.c::init_interval_fd" ref="ce91ebc8b197c6b6ee36dbf7990f3ffe" args="(interval_tree tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void init_interval_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterval__tree__def.html">interval_tree</a>&nbsp;</td>
          <td class="paramname"> <em>tree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize file descriptor for interval tree TREE. 
</div>
</div><p>
<a class="anchor" name="2a06c116c80b124859bdc94fd93ded47"></a><!-- doxytag: member="backup/metadata.c::init_interval_tree" ref="2a06c116c80b124859bdc94fd93ded47" args="(volume vol, internal_fh fh, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool init_interval_tree           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize interval tree of type TYPE for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="da94906a5a608ccbce879dcd37c6d3fd"></a><!-- doxytag: member="backup/metadata.c::init_journal_fd" ref="da94906a5a608ccbce879dcd37c6d3fd" args="(journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void init_journal_fd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize file descriptor for journal JOURNAL. 
</div>
</div><p>
<a class="anchor" name="8072d01b291899dd3fac3db5666afb66"></a><!-- doxytag: member="backup/metadata.c::init_metadata_for_created_volume_root" ref="8072d01b291899dd3fac3db5666afb66" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool init_metadata_for_created_volume_root           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Init metadata for root of volume VOL according to ST so that volume root would be updated. 
</div>
</div><p>
<a class="anchor" name="1bd74b569275131df722d300d754e43b"></a><!-- doxytag: member="backup/metadata.c::init_volume_metadata" ref="1bd74b569275131df722d300d754e43b" args="(volume vol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_volume_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize hash file containing metadata for volume VOL. 
</div>
</div><p>
<a class="anchor" name="8409ce6494102bda76a0b2a2e1e210c0"></a><!-- doxytag: member="backup/metadata.c::initialize_metadata_c" ref="8409ce6494102bda76a0b2a2e1e210c0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_metadata_c           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize data structures in METADATA.C. 
</div>
</div><p>
<a class="anchor" name="da0a8d37ec3b14615265f4621bfea2f0"></a><!-- doxytag: member="backup/metadata.c::interval_opened_p" ref="da0a8d37ec3b14615265f4621bfea2f0" args="(interval_tree tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool interval_opened_p           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterval__tree__def.html">interval_tree</a>&nbsp;</td>
          <td class="paramname"> <em>tree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Is the interval file for interval tree TREE opened? 
</div>
</div><p>
<a class="anchor" name="96a90b0f5e0221e51277ad6a732213aa"></a><!-- doxytag: member="backup/metadata.c::journal_opened_p" ref="96a90b0f5e0221e51277ad6a732213aa" args="(journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool journal_opened_p           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Is the file for journal JOURNAL opened? 
</div>
</div><p>
<a class="anchor" name="976d00e136b8bd8d1a9649593a09c697"></a><!-- doxytag: member="backup/metadata.c::load_interval_trees" ref="976d00e136b8bd8d1a9649593a09c697" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool load_interval_trees           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load interval trees for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="a6db1869c9245582c4cad2ec5f3dfdbf"></a><!-- doxytag: member="backup/metadata.c::lookup_metadata" ref="a6db1869c9245582c4cad2ec5f3dfdbf" args="(volume vol, zfs_fh *fh, metadata *meta, bool insert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lookup_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>insert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Lookup metadata for file handle FH on volume VOL. Store the metadata to META and update FH-&gt;GEN. Insert the metadata to hash file if INSERT is true and the metadata was not found. 
</div>
</div><p>
<a class="anchor" name="546ae02aa9b6fa4eff2db0ffd01aaa54"></a><!-- doxytag: member="backup/metadata.c::metadata_eq" ref="546ae02aa9b6fa4eff2db0ffd01aaa54" args="(const void *x, const void *y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int metadata_eq           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>y</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare element X of hash file with possible element Y. 
</div>
</div><p>
<a class="anchor" name="24a97564272128df1634ba54c890c594"></a><!-- doxytag: member="backup/metadata.c::metadata_hardlink_insert" ref="24a97564272128df1634ba54c890c594" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_insert           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Insert a hardlink [PARENT_DEV, PARENT_INO, NAME] to hardlink list for file handle FH on volume VOL. Use META for loading metadata. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="9afd87ae1e63ab84565a636402d3ce87"></a><!-- doxytag: member="backup/metadata.c::metadata_hardlink_replace" ref="9afd87ae1e63ab84565a636402d3ce87" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t old_parent_dev, uint32_t old_parent_ino, string *old_name, uint32_t new_parent_dev, uint32_t new_parent_ino, string *new_name, bool shadow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_replace           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>old_parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>old_parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>old_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>new_parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>new_parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>new_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>shadow</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Replace a hardlink [OLD_PARENT_DEV, OLD_PARENT_INO, OLD_NAME] by [NEW_PARENT_DEV, NEW_PARENT_INO, NEW_NAME] in hardlink list for file handle FH on volume VOL. Use META for loading metadata. If SHADOW is true set the METADATA_SHADOW flag, otherwise clear it. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="67f5457a19aa44cb6ef37dfc9b5af2af"></a><!-- doxytag: member="backup/metadata.c::metadata_hardlink_set" ref="67f5457a19aa44cb6ef37dfc9b5af2af" args="(volume vol, zfs_fh *fh, metadata *meta, uint32_t parent_dev, uint32_t parent_ino, string *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool metadata_hardlink_set           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>parent_ino</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear the hardlink list of file FH on volume VOL and add a hardlink specifying that the file is in shadow. 
</div>
</div><p>
<a class="anchor" name="a2f8c98f291f07e359e54e823f6c711e"></a><!-- doxytag: member="backup/metadata.c::metadata_hash" ref="a2f8c98f291f07e359e54e823f6c711e" args="(const void *x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hashfile_8h.html#2d05e5049721cf3117dd6b34e20d4f65">hashval_t</a> metadata_hash           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hash function for metadata X. 
</div>
</div><p>
<a class="anchor" name="8aa2d9597003dbf4b52e8df0acbb0d71"></a><!-- doxytag: member="backup/metadata.c::metadata_n_hardlinks" ref="8aa2d9597003dbf4b52e8df0acbb0d71" args="(volume vol, zfs_fh *fh, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int metadata_n_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the number of hardlinks of file FH on volume VOL and store the metadata to META. 
</div>
</div><p>
<a class="anchor" name="646ca4ad8fb8911413174c50d1857d9e"></a><!-- doxytag: member="backup/metadata.c::open_fh_metadata" ref="646ca4ad8fb8911413174c50d1857d9e" args="(string *path, volume vol, zfs_fh *fh, metadata_type type, int flags, mode_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int open_fh_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open metadata file of type TYPE for file handle FH on volume VOL with path PATH, open flags FLAGS and mode MODE. 
</div>
</div><p>
<a class="anchor" name="8d861c333b9d67323a2744f8931246d5"></a><!-- doxytag: member="backup/metadata.c::open_hash_file" ref="8d861c333b9d67323a2744f8931246d5" args="(volume vol, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int open_hash_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open and initialize file descriptor for hash file HFILE of type TYPE. 
</div>
</div><p>
<a class="anchor" name="c70af35adcb1f6604b7ab05bc4231cd3"></a><!-- doxytag: member="backup/metadata.c::open_interval_file" ref="c70af35adcb1f6604b7ab05bc4231cd3" args="(volume vol, internal_fh fh, metadata_type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int open_interval_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="metadata_8h.html#548e14ed3091a841ff4c0eb02062d78e">metadata_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open and initialize file descriptor for interval of type TYPE for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="2f1a32bb3cdb92ff0934b3b5d4fd811e"></a><!-- doxytag: member="backup/metadata.c::open_journal_file" ref="2f1a32bb3cdb92ff0934b3b5d4fd811e" args="(volume vol, journal_t journal, zfs_fh *fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int open_journal_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open and initialize file descriptor for journal JOURNAL for file handle FH on volume VOL. 
</div>
</div><p>
<a class="anchor" name="e337e4328e6a09aa5e7f5af408a4d405"></a><!-- doxytag: member="backup/metadata.c::open_metadata" ref="e337e4328e6a09aa5e7f5af408a4d405" args="(const char *pathname, int flags, mode_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int open_metadata           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>pathname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open metadata file PATHNAME with open flags FLAGS and mode MODE. 
</div>
</div><p>
<a class="anchor" name="518c9b4dbad8f0c6a586a469148a10a3"></a><!-- doxytag: member="backup/metadata.c::read_hardlinks" ref="518c9b4dbad8f0c6a586a469148a10a3" args="(volume vol, zfs_fh *fh, metadata *meta, hardlink_list hl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool read_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read hardlinks for file handle FH on volume VOL to hardlink list HL and the metadata to META. 
</div>
</div><p>
<a class="anchor" name="bfba20ade41d07bca98eed4ca1986f57"></a><!-- doxytag: member="backup/metadata.c::read_hardlinks_file" ref="bfba20ade41d07bca98eed4ca1986f57" args="(hardlink_list sl, int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void read_hardlinks_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read list of hardlinks from file descriptor FD to hardlink list HL. 
</div>
</div><p>
<a class="anchor" name="9785edb2815efbcd6f2a52169997151e"></a><!-- doxytag: member="backup/metadata.c::read_journal" ref="9785edb2815efbcd6f2a52169997151e" args="(volume vol, zfs_fh *fh, journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool read_journal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read journal for file handle FH on volume VOL to JOURNAL. 
</div>
</div><p>
<a class="anchor" name="d873aea7ee86f752791483687c444ac1"></a><!-- doxytag: member="backup/metadata.c::remove_file_and_path" ref="d873aea7ee86f752791483687c444ac1" args="(string *file, unsigned int tree_depth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool remove_file_and_path           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstring__def.html">string</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>tree_depth</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove file FILE and its path upto depth TREE_DEPTH if it is empty. 
</div>
</div><p>
<a class="anchor" name="61e7d7f277cd3c4caf628287c8e508c2"></a><!-- doxytag: member="backup/metadata.c::save_interval_trees" ref="61e7d7f277cd3c4caf628287c8e508c2" args="(volume vol, internal_fh fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool save_interval_trees           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Save interval trees for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="9b5f2db967551a3e834b9b2aa973554f"></a><!-- doxytag: member="backup/metadata.c::set_attr_version" ref="9b5f2db967551a3e834b9b2aa973554f" args="(fattr *attr, metadata *meta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_attr_version           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfattr__def.html">fattr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set version in attributes ATTR according to metadata META. 
</div>
</div><p>
<a class="anchor" name="592bd1089b07aefa0a78331e28d15004"></a><!-- doxytag: member="backup/metadata.c::set_metadata" ref="592bd1089b07aefa0a78331e28d15004" args="(volume vol, internal_fh fh, uint32_t flags, uint64_t local_version, uint64_t master_version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>local_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>master_version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set metadata (FLAGS, LOCAL_VERSION, MASTER_VERSION) for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="6f233b6f69a1cdcb8173d7bfbb2ccbab"></a><!-- doxytag: member="backup/metadata.c::set_metadata_flags" ref="6f233b6f69a1cdcb8173d7bfbb2ccbab" args="(volume vol, internal_fh fh, uint32_t flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata_flags           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set metadata flags FLAGS for file handle FH on volume VOL. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="93fbef76cf9854a4544d6fb002cf29c0"></a><!-- doxytag: member="backup/metadata.c::set_metadata_master_fh" ref="93fbef76cf9854a4544d6fb002cf29c0" args="(volume vol, internal_fh fh, zfs_fh *master_fh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_metadata_master_fh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structinternal__fh__def.html">internal_fh</a>&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>master_fh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set master_fh to MASTER_FH in metadata for file handle FH on volume VOL and update reverse file handle mapping. 
</div>
</div><p>
<a class="anchor" name="b5ffc171cf1357ceb1ec98d6c448245f"></a><!-- doxytag: member="backup/metadata.c::write_hardlinks" ref="b5ffc171cf1357ceb1ec98d6c448245f" args="(volume vol, zfs_fh *fh, metadata *meta, hardlink_list hl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool write_hardlinks           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmetadata__def.html">metadata</a> *&nbsp;</td>
          <td class="paramname"> <em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the hardlink list HL for file handle FH on volume VOL either to hardlink file or to metadata file. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="5a6a2d1f14b618684073f051fa406056"></a><!-- doxytag: member="backup/metadata.c::write_hardlinks_file" ref="5a6a2d1f14b618684073f051fa406056" args="(volume vol, zfs_fh *fh, hardlink_list hl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool write_hardlinks_file           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhardlink__list__def.html">hardlink_list</a>&nbsp;</td>
          <td class="paramname"> <em>hl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write hardlink list HL for file handle FH on volume VOL to hardlink file. Return false on file error. 
</div>
</div><p>
<a class="anchor" name="ef49d0ce915f8bc578649f4ece027342"></a><!-- doxytag: member="backup/metadata.c::write_journal" ref="ef49d0ce915f8bc578649f4ece027342" args="(volume vol, zfs_fh *fh, journal_t journal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool write_journal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvolume__def.html">volume</a>&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structzfs__fh__def.html">zfs_fh</a> *&nbsp;</td>
          <td class="paramname"> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjournal__def.html">journal_t</a>&nbsp;</td>
          <td class="paramname"> <em>journal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the journal JOURNAL for file handle FH on volume VOL to appropriate file. 
</div>
</div><p>
<a class="anchor" name="cca3aa646269f83054c58b6ca1a53b7f"></a><!-- doxytag: member="backup/metadata.c::zfs_mode_to_ftype" ref="cca3aa646269f83054c58b6ca1a53b7f" args="(uint32_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="zfs-prot_8h.html#fd6f88a62c177fab51044d30a2bc4587">ftype</a> zfs_mode_to_ftype           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>mode</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return file type from struct stat's MODE. 
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="cc7d96ba668e6c108a83f7cf8b1e5615"></a><!-- doxytag: member="backup/metadata.c::metadata_fd_data" ref="cc7d96ba668e6c108a83f7cf8b1e5615" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmetadata__fd__data__def.html">metadata_fd_data_t</a>* <a class="el" href="metadata_8c.html#cc7d96ba668e6c108a83f7cf8b1e5615">metadata_fd_data</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The array of data for each file descriptor. 
</div>
</div><p>
<a class="anchor" name="1b5fdef37b8061a83f65a7bd19dab2ac"></a><!-- doxytag: member="backup/metadata.c::metadata_heap" ref="1b5fdef37b8061a83f65a7bd19dab2ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfibheap__def.html">fibheap</a> <a class="el" href="metadata_8c.html#1b5fdef37b8061a83f65a7bd19dab2ac">metadata_heap</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Array of opened metadata file descriptors. 
</div>
</div><p>
<a class="anchor" name="f6426de7676d5ef61b8b8ef79ac00b53"></a><!-- doxytag: member="backup/metadata.c::metadata_mutex" ref="f6426de7676d5ef61b8b8ef79ac00b53" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t <a class="el" href="metadata_8c.html#f6426de7676d5ef61b8b8ef79ac00b53">metadata_mutex</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mutex protecting access to data structures used for opening/closing metadata files. 
</div>
</div><p>
<a class="anchor" name="0897dc5e6757cea8fad80b1c414dee72"></a><!-- doxytag: member="backup/metadata.c::metadata_tree_depth" ref="0897dc5e6757cea8fad80b1c414dee72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="metadata_8h.html#0897dc5e6757cea8fad80b1c414dee72">metadata_tree_depth</a> = 1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Depth of directory tree for saving metadata about files. 
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 6 00:37:41 2010 for zlomekFS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
